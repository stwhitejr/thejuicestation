(function(){window.cloudsponge||(window.cloudsponge={})}).call(this),function(){var e,t,o,n,s,a,c;a=function(e){var t;return t={},e.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,o,n,s){return t[o]=decodeURIComponent(s)}),t},c=function(e,t){var o,n;return t||(t={}),n=/^(https?:)?\/\/([^\/:]+):?([0-9]+)?(\/[^.]*\.js)\??([^\#]*)\#?(.*)$/,(o=n.exec(e))&&(t.src=o[0],t.scheme=o[1]?o[1]:window.location.protocol,t.host=o[2],t.origin=t.scheme+"//"+o[2],o[3]&&(t.port=o[3],t.origin+=":"+o[3]),o[4]&&(t.path=o[4]),o[5]&&(t.search=o[5],t.queryParams=a(o[5])),o[6]&&(t.anchor=o[6])),t},t=function(){var e,t,o,n;return t=new Error,e=/getScriptNameByError \(?([^ ]*):\d+:\d+\)?/,o=/.+ \(?([^ ]*):\d+:\d+\)?$/,(n=e.exec(t.stack.trim()))&&""!==n[1]?n[1]:(n=o.exec(t.stack.trim()))&&""!==n[1]?n[1]:void 0!==t.fileName?t.fileName:void 0},e=function(){var e,t;if(e="__cs-script__",t=document.getElementById(e))return t.src},o=function(){var e,t,o,n,s,a;for(n=/^(https?:)?\/\/([^\/:]+):?([0-9]+)?\/assets\/address_books\/[^.]*\.js\??([^\#]*)\#?(.*)$/,s=document.getElementsByTagName("script"),e=0,t=s.length;e<t;e++)if(a=s[e],o=n.exec(a.src))return o},n=function(){var n,s;return s=document.currentScript&&document.currentScript.src,s||(s=e()),s||(s=t()),s||(s=(n=o())&&n[0]),s},s=function(){var e,t;return e={host:"api.cloudsponge.com",scheme:window.location.protocol,origin:"https://api.cloudsponge.com",search:"",queryParams:{}},(t=n())&&(e=c(t,e)),e},window.cloudsponge.scriptLocation=s()}.call(this),function(e,t,o,n,s,a){function c(e,t){var o=typeof e[t];return"function"==o||!("object"!=o||!e[t])||"unknown"==o}function i(e,t){return!("object"!=typeof e[t]||!e[t])}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}function l(){var e="Shockwave Flash",t="application/x-shockwave-flash";if(!T(navigator.plugins)&&"object"==typeof navigator.plugins[e]){var o=navigator.plugins[e].description;o&&!T(navigator.mimeTypes)&&navigator.mimeTypes[t]&&navigator.mimeTypes[t].enabledPlugin&&(I=o.match(/\d+/g))}if(!I){var n;try{n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),I=Array.prototype.slice.call(n.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1),n=null}catch(e){}}if(!I)return!1;var s=parseInt(I[0],10),a=parseInt(I[1],10);return U=s>9&&a>0,!0}function d(){if(!K){K=!0,G("firing dom_onReady");for(var e=0;e<X.length;e++)X[e]();X.length=0}}function u(e,t){if(K)return void e.call(t);X.push(function(){e.call(t)})}function p(){var e=parent;if(""!==H)for(var t=0,o=H.split(".");t<o.length;t++){if(!e)throw new Error(o.slice(0,t+1).join(".")+" is not an object");e=e[o[t]]}if(!e||!e.easyXDM)throw new Error("Could not find easyXDM in parent."+H);return e.easyXDM}function g(t){if("string"!=typeof t||!t)throw new Error("namespace must be a non-empty string");return G("Settings namespace to '"+t+"'"),e.easyXDM=W,H=t,H&&($="easyXDM_"+H.replace(".","_")+"_"),V}function f(e){if(!e)throw new Error("url is undefined or empty");return e.match(D)[3]}function m(e){if(!e)throw new Error("url is undefined or empty");return e.match(D)[4]||""}function h(e){if(!e)throw new Error("url is undefined or empty");if(/^file/.test(e))throw new Error("The file:// protocol is not supported");var t=e.toLowerCase().match(D)||[],o=t[2]||"",n=t[3]||"",s=t[4]||"";return("http:"==o&&":80"==s||"https:"==o&&":443"==s)&&(s=""),o+"//"+n+s}function C(e){if(!e)throw new Error("url is undefined or empty");if(e=e.replace(x,"$1/"),!e.match(/^(http||https):\/\//)){var t="/"===e.substring(0,1)?"":o.pathname;"/"!==t.substring(t.length-1)&&(t=t.substring(0,t.lastIndexOf("/")+1)),e=o.protocol+"//"+o.host+t+e}for(;P.test(e);)e=e.replace(P,"");return G("resolved url '"+e+"'"),e}function E(e,t){if(!t)throw new Error("parameters is undefined or null");var o="",n=e.indexOf("#");-1!==n&&(o=e.substring(n),e=e.substring(0,n));var s=[];for(var c in t)t.hasOwnProperty(c)&&s.push(c+"="+a(t[c]));return e+(j?"#":-1==e.indexOf("?")?"?":"&")+s.join("&")+o}function T(e){return void 0===e}function _(e,t,o){var n;for(var s in t)t.hasOwnProperty(s)&&(s in e?(n=t[s],"object"==typeof n?_(e[s],n,o):o||(e[s]=t[s])):e[s]=t[s]);return e}function v(){var e=t.body.appendChild(t.createElement("form")),o=e.appendChild(t.createElement("input"));o.name=$+"TEST"+B,w=o!==e.elements[o.name],t.body.removeChild(e),G("HAS_NAME_PROPERTY_BUG: "+w)}function S(e){G("creating frame: "+e.props.src),T(w)&&v();var o;w?o=t.createElement('<iframe name="'+e.props.name+'"/>'):(o=t.createElement("IFRAME"),o.name=e.props.name),o.id=o.name=e.props.name,delete e.props.name,"string"==typeof e.container&&(e.container=t.getElementById(e.container)),e.container||(_(o.style,{position:"absolute",top:"-2000px",left:"0px"}),e.container=t.body);var n=e.props.src;if(e.props.src="javascript:false",_(o,e.props),o.border=o.frameBorder=0,o.allowTransparency=!0,o.tabIndex=-1,e.container.appendChild(o),e.onLoad&&N(o,"load",e.onLoad),e.usePost){var s,a=e.container.appendChild(t.createElement("form"));if(a.target=o.name,a.action=n,a.method="POST","object"==typeof e.usePost)for(var c in e.usePost)e.usePost.hasOwnProperty(c)&&(w?s=t.createElement('<input name="'+c+'"/>'):(s=t.createElement("INPUT"),s.name=c),s.value=e.usePost[c],a.appendChild(s));a.submit(),a.parentNode.removeChild(a)}else o.src=n;return e.props.src=n,o}function O(e,t){"string"==typeof e&&(e=[e]);for(var o,n=e.length;n--;)if(o=e[n],o=new RegExp("^"==o.substr(0,1)?o:"^"+o.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),o.test(t))return!0;return!1}function A(n){var s,a=n.protocol;if(n.isHost=n.isHost||T(Y.xdm_p),j=n.hash||!1,G("preparing transport stack"),n.props||(n.props={}),n.isHost)n.remote=C(n.remote),n.channel=n.channel||"default"+B++,n.secret=Math.random().toString(16).substring(2),T(a)?(a=h(o.href)==h(n.remote)?"4":c(e,"postMessage")||c(t,"postMessage")?"1":n.swf&&c(e,"ActiveXObject")&&l()?"6":"Gecko"===navigator.product&&"frameElement"in e&&-1==navigator.userAgent.indexOf("WebKit")?"5":n.remoteHelper?"2":"0",G("selecting protocol: "+a)):G("using protocol: "+a);else if(G("using parameters from query"),n.channel=Y.xdm_c.replace(/["'<>\\]/g,""),n.secret=Y.xdm_s,n.remote=Y.xdm_e.replace(/["'<>\\]/g,""),a=Y.xdm_p,n.acl&&!O(n.acl,n.remote))throw new Error("Access denied for "+n.remote);switch(n.protocol=a,a){case"0":if(_(n,{interval:100,delay:2e3,useResize:!0,useParent:!1,usePolling:!1},!0),n.isHost){if(!n.local){G("looking for image to use as local");for(var i,r=o.protocol+"//"+o.host,d=t.body.getElementsByTagName("img"),u=d.length;u--;)if(i=d[u],i.src.substring(0,r.length)===r){n.local=i.src;break}n.local||(G("no image found, defaulting to using the window"),n.local=e)}var p={xdm_c:n.channel,xdm_p:0};n.local===e?(n.usePolling=!0,n.useParent=!0,n.local=o.protocol+"//"+o.host+o.pathname+o.search,p.xdm_e=n.local,p.xdm_pa=1):p.xdm_e=C(n.local),n.container&&(n.useResize=!1,p.xdm_po=1),n.remote=E(n.remote,p)}else _(n,{useParent:!T(Y.xdm_pa),usePolling:!T(Y.xdm_po),useResize:!n.useParent&&n.useResize});s=[new V.stack.HashTransport(n),new V.stack.ReliableBehavior({}),new V.stack.QueueBehavior({encode:!0,maxLength:4e3-n.remote.length}),new V.stack.VerifyBehavior({initiate:n.isHost})];break;case"1":s=[new V.stack.PostMessageTransport(n)];break;case"2":n.isHost&&(n.remoteHelper=C(n.remoteHelper)),s=[new V.stack.NameTransport(n),new V.stack.QueueBehavior,new V.stack.VerifyBehavior({initiate:n.isHost})];break;case"3":s=[new V.stack.NixTransport(n)];break;case"4":s=[new V.stack.SameOriginTransport(n)];break;case"5":s=[new V.stack.FrameElementTransport(n)];break;case"6":I||l(),s=[new V.stack.FlashTransport(n)]}return s.push(new V.stack.QueueBehavior({lazy:n.lazy,remove:!0})),s}function b(e){for(var t,o={incoming:function(e,t){this.up.incoming(e,t)},outgoing:function(e,t){this.down.outgoing(e,t)},callback:function(e){this.up.callback(e)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}},n=0,s=e.length;n<s;n++)t=e[n],_(t,o,!0),0!==n&&(t.down=e[n-1]),n!==s-1&&(t.up=e[n+1]);return t}function y(e){e.up.down=e.down,e.down.up=e.up,e.up=e.down=null}function L(){return e.cloudsponge&&"true"===cloudsponge.scriptLocation.queryParams.debug||o.search.match(/debug=(true|1)/)}var w,I,U,N,k,R=this,B=Math.floor(1e4*Math.random()),M=Function.prototype,D=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,P=/[\-\w]+\/\.\.\//,x=/([^:])\/\//g,H="",V={},W=e.easyXDM,$="easyXDM_",j=!1,G=M;if(c(e,"addEventListener"))N=function(e,t,o){G("adding listener "+t),e.addEventListener(t,o,!1)},k=function(e,t,o){G("removing listener "+t),e.removeEventListener(t,o,!1)};else{if(!c(e,"attachEvent"))throw new Error("Browser not supported");N=function(e,t,o){G("adding listener "+t),e.attachEvent("on"+t,o)},k=function(e,t,o){G("removing listener "+t),e.detachEvent("on"+t,o)}}var F,K=!1,X=[];if("readyState"in t?(F=t.readyState,K="complete"==F||~navigator.userAgent.indexOf("AppleWebKit/")&&("loaded"==F||"interactive"==F)):K=!!t.body,!K){if(c(e,"addEventListener"))N(t,"DOMContentLoaded",d);else if(N(t,"readystatechange",function(){"complete"==t.readyState&&d()}),t.documentElement.doScroll&&e===top){var q=function(){if(!K){try{t.documentElement.doScroll("left")}catch(e){return void n(q,1)}d()}};q()}N(e,"load",d)}var Y=function(e){e=e.substring(1).split("&");for(var t,o={},n=e.length;n--;)t=e[n].split("="),o[t[0]]=s(t[1]);return o}(/xdm_e=/.test(o.search)?o.search:o.hash),z=function(){var e={},t={a:[1,2,3]},o='{"a":[1,2,3]}';return"undefined"!=typeof JSON&&"function"==typeof JSON.stringify&&JSON.stringify(t).replace(/\s/g,"")===o?JSON:(Object.toJSON&&Object.toJSON(t).replace(/\s/g,"")===o&&(e.stringify=Object.toJSON),"function"==typeof String.prototype.evalJSON&&(t=o.evalJSON(),t.a&&3===t.a.length&&3===t.a[2]&&(e.parse=function(e){return e.evalJSON()})),e.stringify&&e.parse?(z=function(){return e},e):null)};_(V,{version:"2.4.20.7",query:Y,stack:{},apply:_,getJSONObject:z,whenReady:u,noConflict:g}),_(V,{checkAcl:O,getDomainName:f,getLocation:h,appendQueryParameters:E});var J={_deferred:[],flush:function(){this.trace("... deferred messages ...");for(var e=0,t=this._deferred.length;e<t;e++)this.trace(this._deferred[e]);this._deferred.length=0,this.trace("... end of deferred messages ...")},getTime:function(){var e=new Date,t=e.getHours()+"",o=e.getMinutes()+"",n=e.getSeconds()+"",s=e.getMilliseconds()+"";return 1==t.length&&(t="0"+t),1==o.length&&(o="0"+o),1==n.length&&(n="0"+n),s="000".substring(s.length)+s,t+":"+o+":"+n+"."+s},log:function(t){!i(e,"console")||T(console.log)?this.log=M:this.log=function(e){console.log(o.host+(H?":"+H:"")+" - "+this.getTime()+": "+e)},this.log(t)},trace:function(n){if(K){var s=t.getElementById("log");if(s)this.trace=function(e){try{s.appendChild(t.createElement("div")).appendChild(t.createTextNode(o.host+(H?":"+H:"")+" - "+this.getTime()+":"+e)),s.scrollTop=s.scrollHeight}catch(e){}};else if(i(e,"console")&&!T(console.info))this.trace=function(e){console.info(o.host+(H?":"+H:"")+" - "+this.getTime()+":"+e)};else{var a,c=o.host,r=c.replace(/[\-.:]/g,"")+"easyxdm_log";try{a=e.open("",r,"width=800,height=200,status=0,navigation=0,scrollbars=1")}catch(e){}if(a){var l=a.document;s=l.getElementById("log"),s||(l.write("<html><head><title>easyXDM log "+c+"</title></head>"),l.write('<body><div id="log"></div></body></html>'),l.close(),s=l.getElementById("log")),this.trace=function(e){try{s.appendChild(l.createElement("div")).appendChild(l.createTextNode(o.host+(H?":"+H:"")+" - "+this.getTime()+":"+e)),s.scrollTop=s.scrollHeight}catch(e){}},this.trace("---- new logger at "+o.href)}s||(this.trace=M)}this.trace(n)}else 0===this._deferred.length&&V.whenReady(J.flush,J),this._deferred.push(n),this.log(n)},getTracer:function(e){return function(t){J.trace(e+": "+t)}}};L()||(J.log=J.trace=function(){return!1}),J.log("easyXDM present on '"+o.href),V.Debug=J,G=J.getTracer("{Private}"),V.DomHelper={on:N,un:k,requiresJSON:function(o){i(e,"JSON")?J.log("native JSON found"):(J.log("loading external JSON"),t.write('<script type="text/javascript" src="'+o+'"></script>'))}},function(){var e={};V.Fn={set:function(t,o){this._trace("storing function "+t),e[t]=o},get:function(t,o){if(this._trace("retrieving function "+t),e.hasOwnProperty(t)){var n=e[t];return n||this._trace(t+" not found"),o&&delete e[t],n}}},V.Fn._trace=J.getTracer("easyXDM.Fn")}(),V.Socket=function(e){J.getTracer("easyXDM.Socket")("constructor");var t=b(A(e).concat([{incoming:function(t,o){e.onMessage(t,o)},callback:function(t){e.onReady&&e.onReady(t)}}])),o=h(e.remote);this.origin=h(e.remote),this.destroy=function(){t.destroy()},this.postMessage=function(e){t.outgoing(e,o)},t.init()},V.Rpc=function(e,t){if(J.getTracer("easyXDM.Rpc")("constructor"),t.local)for(var o in t.local)if(t.local.hasOwnProperty(o)){var n=t.local[o];"function"==typeof n&&(t.local[o]={method:n})}var s=b(A(e).concat([new V.stack.RpcBehavior(this,t),{callback:function(t){e.onReady&&e.onReady(t)}}]));this.origin=h(e.remote),this.destroy=function(){s.destroy()},s.init()},V.stack.SameOriginTransport=function(e){var t=J.getTracer("easyXDM.stack.SameOriginTransport");t("constructor");var s,a,c,i;return s={outgoing:function(e,t,o){c(e),o&&o()},destroy:function(){t("destroy"),a&&(a.parentNode.removeChild(a),a=null)},onDOMReady:function(){t("init"),i=h(e.remote),e.isHost?(_(e.props,{src:E(e.remote,{xdm_e:o.protocol+"//"+o.host+o.pathname,xdm_c:e.channel,xdm_p:4}),name:$+e.channel+"_provider"}),a=S(e),V.Fn.set(e.channel,function(e){return c=e,n(function(){s.up.callback(!0)},0),function(e){s.up.incoming(e,i)}})):(c=p().Fn.get(e.channel,!0)(function(e){s.up.incoming(e,i)}),n(function(){s.up.callback(!0)},0))},init:function(){u(s.onDOMReady,s)}}},V.stack.FlashTransport=function(e){function s(e){n(function(){i("received message"),r.up.incoming(e,d)},0)}function c(o){i("creating factory with SWF from "+o);var n=e.swf+"?host="+e.isHost,s="easyXDM_swf_"+Math.floor(1e4*Math.random());V.Fn.set("flash_loaded"+o.replace(/[\-.]/g,"_"),function(){V.stack.FlashTransport[o].swf=p=g.firstChild;for(var e=V.stack.FlashTransport[o].queue,t=0;t<e.length;t++)e[t]();e.length=0}),e.swfContainer?g="string"==typeof e.swfContainer?t.getElementById(e.swfContainer):e.swfContainer:(g=t.createElement("div"),_(g.style,U&&e.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0}),t.body.appendChild(g));var c="callback=flash_loaded"+a(o.replace(/[\-.]/g,"_"))+"&proto="+R.location.protocol+"&domain="+a(f(R.location.href))+"&port="+a(m(R.location.href))+"&ns="+a(H);c+="&log=true",g.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+s+"' data='"+n+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+n+"'></param><param name='flashvars' value='"+c+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+c+"' allowScriptAccess='always' wmode='transparent' src='"+n+"' height='1' width='1'></embed></object>"}var i=J.getTracer("easyXDM.stack.FlashTransport");if(i("constructor"),!e.swf)throw new Error("Path to easyxdm.swf is missing");var r,l,d,p,g;return r={outgoing:function(t,o,n){p.postMessage(e.channel,t.toString()),n&&n()},destroy:function(){i("destroy");try{p.destroyChannel(e.channel)}catch(e){}p=null,l&&(l.parentNode.removeChild(l),l=null)},onDOMReady:function(){i("init"),d=e.remote,V.Fn.set("flash_"+e.channel+"_init",function(){n(function(){i("firing onReady"),r.up.callback(!0)})}),V.Fn.set("flash_"+e.channel+"_onMessage",s),e.swf=C(e.swf);var t=f(e.swf),a=function(){V.stack.FlashTransport[t].init=!0,p=V.stack.FlashTransport[t].swf,p.createChannel(e.channel,e.secret,h(e.remote),e.isHost),e.isHost&&(U&&e.swfNoThrottle&&_(e.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"}),_(e.props,{src:E(e.remote,{xdm_e:h(o.href),xdm_c:e.channel,xdm_p:6,xdm_s:e.secret}),name:$+e.channel+"_provider"}),l=S(e))};V.stack.FlashTransport[t]&&V.stack.FlashTransport[t].init?a():V.stack.FlashTransport[t]?V.stack.FlashTransport[t].queue.push(a):(V.stack.FlashTransport[t]={queue:[a]},c(t))},init:function(){u(r.onDOMReady,r)}}},V.stack.PostMessageTransport=function(t){function s(e){if(e.origin)return h(e.origin);if(e.uri)return h(e.uri);if(e.domain)return o.protocol+"//"+e.domain;throw"Unable to retrieve the origin of the event"}function a(e){if("string"==typeof e.data){var o=s(e);i("received message '"+e.data+"' from "+o),o==p&&e.data.substring(0,t.channel.length+1)==t.channel+" "&&r.up.incoming(e.data.substring(t.channel.length+1),o)}}function c(o){o.data==t.channel+"-ready"&&(i("firing onReady"),d="postMessage"in l.contentWindow?l.contentWindow:l.contentWindow.document,k(e,"message",c),N(e,"message",a),n(function(){r.up.callback(!0)},0))}var i=J.getTracer("easyXDM.stack.PostMessageTransport");i("constructor");var r,l,d,p;return r={outgoing:function(e,o,n){d.postMessage(t.channel+" "+e,o||p),n&&n()},destroy:function(){i("destroy"),k(e,"message",c),k(e,"message",a),l&&(d=null,l.parentNode.removeChild(l),l=null)},onDOMReady:function(){i("init"),p=h(t.remote),t.isHost?(N(e,"message",c),_(t.props,{src:E(t.remote,{xdm_e:h(o.href),xdm_c:t.channel,xdm_p:1}),name:$+t.channel+"_provider"}),l=S(t)):(N(e,"message",a),d="postMessage"in e.parent?e.parent:e.parent.document,d.postMessage(t.channel+"-ready",p),n(function(){r.up.callback(!0)},0))},init:function(){u(r.onDOMReady,r)}}},V.stack.FrameElementTransport=function(s){var a=J.getTracer("easyXDM.stack.FrameElementTransport");a("constructor");var c,i,r,l;return c={outgoing:function(e,t,o){r.call(this,e),o&&o()},destroy:function(){a("destroy"),i&&(i.parentNode.removeChild(i),i=null)},onDOMReady:function(){a("init"),l=h(s.remote),s.isHost?(_(s.props,{src:E(s.remote,{xdm_e:h(o.href),xdm_c:s.channel,xdm_p:5}),name:$+s.channel+"_provider"}),i=S(s),i.fn=function(e){return delete i.fn,r=e,n(function(){c.up.callback(!0)},0),function(e){c.up.incoming(e,l)}}):(t.referrer&&h(t.referrer)!=Y.xdm_e&&(e.top.location=Y.xdm_e),r=e.frameElement.fn(function(e){c.up.incoming(e,l)}),c.up.callback(!0))},init:function(){u(c.onDOMReady,c)}}},V.stack.NameTransport=function(e){function t(t){var o=e.remoteHelper+(r?"#_3":"#_2")+e.channel;c("sending message "+t),c("navigating to  '"+o+"'"),l.contentWindow.sendMessage(t,o)}function o(){r?2!=++p&&r||i.up.callback(!0):(t("ready"),c("calling onReady"),i.up.callback(!0))}function s(e){c("received message "+e),i.up.incoming(e,f)}function a(){g&&n(function(){g(!0)},0)}var c=J.getTracer("easyXDM.stack.NameTransport");if(c("constructor"),e.isHost&&T(e.remoteHelper))throw c("missing remoteHelper"),new Error("missing remoteHelper");var i,r,l,d,p,g,f,m;return i={outgoing:function(e,o,n){g=n,t(e)},destroy:function(){c("destroy"),l.parentNode.removeChild(l),l=null,r&&(d.parentNode.removeChild(d),d=null)},onDOMReady:function(){c("init"),r=e.isHost,p=0,f=h(e.remote),e.local=C(e.local),r?(V.Fn.set(e.channel,function(t){c("received initial message "+t),r&&"ready"===t&&(V.Fn.set(e.channel,s),o())}),m=E(e.remote,{xdm_e:e.local,xdm_c:e.channel,xdm_p:2}),_(e.props,{src:m+"#"+e.channel,name:$+e.channel+"_provider"}),d=S(e)):(e.remoteHelper=e.remote,V.Fn.set(e.channel,s));var t=function(){var s=l||this;k(s,"load",t),V.Fn.set(e.channel+"_load",a),function e(){"function"==typeof s.contentWindow.sendMessage?o():n(e,50)}()};l=S({props:{src:e.local+"#_4"+e.channel},onLoad:t})},init:function(){u(i.onDOMReady,i)}}},V.stack.HashTransport=function(t){function o(e){if(i("sending message '"+(f+1)+" "+e+"' to "+T),!C)return void i("no caller window");var o=t.remote+"#"+f+++"_"+e;(l||!E?C.contentWindow:C).location=o}function s(e){g=e,i("received message '"+g+"' from "+T),r.up.incoming(g.substring(g.indexOf("_")+1),T)}function a(){if(m){var e=m.location.href,t="",o=e.indexOf("#");-1!=o&&(t=e.substring(o)),t&&t!=g&&(i("poll: new message"),s(t))}}function c(){i("starting polling"),d=setInterval(a,p)}var i=J.getTracer("easyXDM.stack.HashTransport");i("constructor");var r,l,d,p,g,f,m,C,E,T;return r={outgoing:function(e){o(e)},destroy:function(){e.clearInterval(d),!l&&E||C.parentNode.removeChild(C),C=null},onDOMReady:function(){if(l=t.isHost,p=t.interval,g="#"+t.channel,f=0,E=t.useParent,T=h(t.remote),l){if(_(t.props,{src:t.remote,name:$+t.channel+"_provider"}),E)t.onLoad=function(){m=e,c(),r.up.callback(!0)};else{var o=0,s=t.delay/50;!function e(){if(++o>s)throw i("unable to get reference to _listenerWindow, giving up"),new Error("Unable to reference listenerwindow");try{m=C.contentWindow.frames[$+t.channel+"_consumer"]}catch(e){}m?(c(),i("got a reference to _listenerWindow"),r.up.callback(!0)):n(e,50)}()}C=S(t)}else m=e,c(),E?(C=parent,r.up.callback(!0)):(_(t,{props:{src:t.remote+"#"+t.channel+new Date,name:$+t.channel+"_consumer"},onLoad:function(){r.up.callback(!0)}}),C=S(t))},init:function(){u(r.onDOMReady,r)}}},V.stack.ReliableBehavior=function(){var e=J.getTracer("easyXDM.stack.ReliableBehavior");e("constructor");var t,o,n=0,s=0,a="";return t={incoming:function(c,i){e("incoming: "+c);var r=c.indexOf("_"),l=c.substring(0,r).split(",");c=c.substring(r+1),l[0]==n&&(e("message delivered"),a="",o&&o(!0)),c.length>0&&(e("sending ack, and passing on "+c),t.down.outgoing(l[1]+","+n+"_"+a,i),s!=l[1]&&(s=l[1],t.up.incoming(c,i)))},outgoing:function(e,c,i){a=e,o=i,t.down.outgoing(s+","+ ++n+"_"+e,c)}}},V.stack.QueueBehavior=function(e){function t(){if(e.remove&&0===r.length)return o("removing myself from the stack"),void y(c);if(!l&&0!==r.length&&!i){o("dispatching from queue"),l=!0;var s=r.shift();c.down.outgoing(s.data,s.origin,function(e){l=!1,s.callback&&n(function(){s.callback(e)},0),t()})}}var o=J.getTracer("easyXDM.stack.QueueBehavior");o("constructor");var c,i,r=[],l=!0,d="",u=0,p=!1,g=!1;return c={init:function(){T(e)&&(e={}),e.maxLength&&(u=e.maxLength,g=!0),e.lazy?p=!0:c.down.init()},callback:function(e){l=!1;var o=c.up;t(),o.callback(e)},incoming:function(t,n){if(g){var a=t.indexOf("_"),i=parseInt(t.substring(0,a),10);d+=t.substring(a+1),0===i?(o("received the last fragment"),e.encode&&(d=s(d)),c.up.incoming(d,n),d=""):o("waiting for more fragments, seq="+t)}else c.up.incoming(t,n)},outgoing:function(n,s,i){e.encode&&(n=a(n));var l,d=[];if(g){for(;0!==n.length;)l=n.substring(0,u),n=n.substring(l.length),d.push(l);for(;l=d.shift();)o("enqueuing"),r.push({data:d.length+"_"+l,origin:s,callback:0===d.length?i:null})}else r.push({data:n,origin:s,callback:i});p?c.down.init():t()},destroy:function(){o("destroy"),i=!0,c.down.destroy()}}},V.stack.VerifyBehavior=function(e){function t(){o("requesting verification"),s=Math.random().toString(16).substring(2),n.down.outgoing(s)}var o=J.getTracer("easyXDM.stack.VerifyBehavior");if(o("constructor"),T(e.initiate))throw new Error("settings.initiate is not set");var n,s,a;return n={incoming:function(c,i){var r=c.indexOf("_");-1===r?c===s?(o("verified, calling callback"),n.up.callback(!0)):a||(o("returning secret"),a=c,e.initiate||t(),n.down.outgoing(c)):c.substring(0,r)===a&&n.up.incoming(c.substring(r+1),i)},outgoing:function(e,t,o){n.down.outgoing(s+"_"+e,t,o)},callback:function(){e.initiate&&t()}}},V.stack.RpcBehavior=function(e,t){function o(e){e.jsonrpc="2.0",a.down.outgoing(i.stringify(e))}function n(e,t){var n=Array.prototype.slice;return c("creating method "+t),function(){c("executing method "+t);var s,a=arguments.length,i={method:t};a>0&&"function"==typeof arguments[a-1]?(a>1&&"function"==typeof arguments[a-2]?(s={success:arguments[a-2],error:arguments[a-1]},i.params=n.call(arguments,0,a-2)):(s={success:arguments[a-1]},i.params=n.call(arguments,0,a-1)),d[""+ ++l]=s,i.id=l):i.params=n.call(arguments,0),e.namedParams&&1===i.params.length&&(i.params=i.params[0]),o(i)}}function s(e,t,n,s){if(!n)return c("requested to execute non-existent procedure "+e),void(t&&o({id:t,error:{code:-32601,message:"Procedure not found."}}));c("requested to execute procedure "+e);var a,i;t?(a=function(e){a=M,o({id:t,result:e})},i=function(e,n){i=M;var s={id:t,error:{code:-32099,message:e}};n&&(s.error.data=n),o(s)}):a=i=M,r(s)||(s=[s]);try{var l=n.method.apply(n.scope,s.concat([a,i]));T(l)||a(l)}catch(e){i(e.message)}}var a,c=J.getTracer("easyXDM.stack.RpcBehavior"),i=t.serializer||z(),l=0,d={};return a={incoming:function(e){var n=i.parse(e);if(n.method)c("received request to execute method "+n.method+(n.id?" using callback id "+n.id:"")),t.handle?t.handle(n,o):s(n.method,n.id,t.local[n.method],n.params);else{c("received return value destined to callback with id "+n.id);var a=d[n.id];n.error?a.error?a.error(n.error):c("unhandled error returned."):a.success&&a.success(n.result),delete d[n.id]}},init:function(){if(c("init"),t.remote){c("creating stubs");for(var o in t.remote)t.remote.hasOwnProperty(o)&&(e[o]=n(t.remote[o],o))}a.down.init()},destroy:function(){c("destroy");for(var o in t.remote)t.remote.hasOwnProperty(o)&&e.hasOwnProperty(o)&&delete e[o];a.down.destroy()}}},R.easyXDM=V}(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent);var _csdigest=function(){function e(e,t){var c=e[0],i=e[1],r=e[2],l=e[3];c=o(c,i,r,l,t[0],7,-680876936),l=o(l,c,i,r,t[1],12,-389564586),r=o(r,l,c,i,t[2],17,606105819),i=o(i,r,l,c,t[3],22,-1044525330),c=o(c,i,r,l,t[4],7,-176418897),l=o(l,c,i,r,t[5],12,1200080426),r=o(r,l,c,i,t[6],17,-1473231341),i=o(i,r,l,c,t[7],22,-45705983),c=o(c,i,r,l,t[8],7,1770035416),l=o(l,c,i,r,t[9],12,-1958414417),r=o(r,l,c,i,t[10],17,-42063),i=o(i,r,l,c,t[11],22,-1990404162),c=o(c,i,r,l,t[12],7,1804603682),l=o(l,c,i,r,t[13],12,-40341101),r=o(r,l,c,i,t[14],17,-1502002290),i=o(i,r,l,c,t[15],22,1236535329),c=n(c,i,r,l,t[1],5,-165796510),l=n(l,c,i,r,t[6],9,-1069501632),r=n(r,l,c,i,t[11],14,643717713),i=n(i,r,l,c,t[0],20,-373897302),c=n(c,i,r,l,t[5],5,-701558691),l=n(l,c,i,r,t[10],9,38016083),r=n(r,l,c,i,t[15],14,-660478335),i=n(i,r,l,c,t[4],20,-405537848),c=n(c,i,r,l,t[9],5,568446438),l=n(l,c,i,r,t[14],9,-1019803690),r=n(r,l,c,i,t[3],14,-187363961),i=n(i,r,l,c,t[8],20,1163531501),c=n(c,i,r,l,t[13],5,-1444681467),l=n(l,c,i,r,t[2],9,-51403784),r=n(r,l,c,i,t[7],14,1735328473),i=n(i,r,l,c,t[12],20,-1926607734),c=s(c,i,r,l,t[5],4,-378558),l=s(l,c,i,r,t[8],11,-2022574463),r=s(r,l,c,i,t[11],16,1839030562),i=s(i,r,l,c,t[14],23,-35309556),c=s(c,i,r,l,t[1],4,-1530992060),l=s(l,c,i,r,t[4],11,1272893353),r=s(r,l,c,i,t[7],16,-155497632),i=s(i,r,l,c,t[10],23,-1094730640),c=s(c,i,r,l,t[13],4,681279174),l=s(l,c,i,r,t[0],11,-358537222),r=s(r,l,c,i,t[3],16,-722521979),i=s(i,r,l,c,t[6],23,76029189),c=s(c,i,r,l,t[9],4,-640364487),l=s(l,c,i,r,t[12],11,-421815835),r=s(r,l,c,i,t[15],16,530742520),i=s(i,r,l,c,t[2],23,-995338651),c=a(c,i,r,l,t[0],6,-198630844),l=a(l,c,i,r,t[7],10,1126891415),r=a(r,l,c,i,t[14],15,-1416354905),i=a(i,r,l,c,t[5],21,-57434055),c=a(c,i,r,l,t[12],6,1700485571),l=a(l,c,i,r,t[3],10,-1894986606),r=a(r,l,c,i,t[10],15,-1051523),i=a(i,r,l,c,t[1],21,-2054922799),c=a(c,i,r,l,t[8],6,1873313359),l=a(l,c,i,r,t[15],10,-30611744),r=a(r,l,c,i,t[6],15,-1560198380),i=a(i,r,l,c,t[13],21,1309151649),c=a(c,i,r,l,t[4],6,-145523070),l=a(l,c,i,r,t[11],10,-1120210379),r=a(r,l,c,i,t[2],15,718787259),i=a(i,r,l,c,t[9],21,-343485551),e[0]=d(c,e[0]),e[1]=d(i,e[1]),e[2]=d(r,e[2]),e[3]=d(l,e[3])}function t(e,t,o,n,s,a){return t=d(d(t,e),d(n,a)),d(t<<s|t>>>32-s,o)}function o(e,o,n,s,a,c,i){return t(o&n|~o&s,e,o,a,c,i)}function n(e,o,n,s,a,c,i){return t(o&s|n&~s,e,o,a,c,i)}function s(e,o,n,s,a,c,i){return t(o^n^s,e,o,a,c,i)}function a(e,o,n,s,a,c,i){return t(n^(o|~s),e,o,a,c,i)}function c(t){txt="";var o,n=t.length,s=[1732584193,-271733879,-1732584194,271733878];for(o=64;o<=t.length;o+=64)e(s,i(t.substring(o-64,o)));t=t.substring(o-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(o=0;o<t.length;o++)a[o>>2]|=t.charCodeAt(o)<<(o%4<<3);if(a[o>>2]|=128<<(o%4<<3),o>55)for(e(s,a),o=0;o<16;o++)a[o]=0;return a[14]=8*n,e(s,a),s}function i(e){var t,o=[];for(t=0;t<64;t+=4)o[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return o}function r(e){for(var t="",o=0;o<4;o++)t+=u[e>>8*o+4&15]+u[e>>8*o&15];return t}function l(e){for(var t=0;t<e.length;t++)e[t]=r(e[t]);return e.join("")}function d(e,t){return e+t&4294967295}function d(e,t){var o=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(o>>16)<<16|65535&o}var u="0123456789abcdef".split(""),p=function(e){return l(c(e))};return p("hello"),{md5:p}}();if(csCollect=function(e,t){function o(e){f.trackingId=e.trackingId,u=e.name||"",p=e.alwaysSendReferrer||!1,m.clientId=a()}function n(){return Math.round((new Date).getTime()/1e3)}function s(){function t(){return Math.round(2147483647*Math.random())}function o(e){var t,o,n=1;if(e)for(n=0,o=e.length-1;0<=o;o--)t=e.charCodeAt(o),n=(n<<6&268435455)+t+(t<<14),0!=(t=266338304&n)&&(n^=t>>21);return n}for(var s=window.navigator.userAgent+(document.cookie?document.cookie:"")+(document.referrer?document.referrer:""),a=s.length,c=e.history.length;0<c;)s+=c--^a++;return[t()^2147483647&o(s),n()].join(".")}function a(){var e=document.cookie.match(g+"=([a-z0-9A-Z.]+);");if(e)d=e[1];else{d="CA1.1."+s();var t=new Date;t.setTime(t.getTime()+63072e6),document.cookie=g+"="+d+"; expires="+t.toGMTString()}return d}function c(e,t){e=e||{},t=t||{};for(var o=Object.keys(t),n=0,s=o.length;n<s;n++)e[o[n]]=t[o[n]];return e}function i(e,t){c(t,f),c(t,m),c(t,e),t.hasOwnProperty("page")&&t.page&&t.page.length&&delete t.location;var o={};for(var n in h)t.hasOwnProperty(n)&&null!=t[n]&&t[n]!=undefined&&(o[h[n]]=t[n]);return o}function r(e){var t=[];for(var o in e)e.hasOwnProperty(o)&&t.push(o+"="+encodeURIComponent(e[o]));return t.join("&")}function l(e){var t=new XMLHttpRequest;t.open("GET",e),t.send()}var d=null,u=null,p=null,g="_cloudspongea",f={trackingId:""},m={clientId:""},h=(t.location.pathname,t.title,t.referrer?t.referrer:t.location.toString(),{appName:"an",trackingId:"tid",page:"dl",location:"dl",title:"dt",referrer:"dr",dimension1:"k",appVersion:"av",clientId:"cid",type:"t",dimension3:"s",eventCategory:"ec",eventAction:"ea",eventValue:"ev",metric1:"m1",metric2:"m2",timestamp:"ts"});return function(e,t,n){switch(e){case"create":o(t);break;case"set":m[t]=n;break;case"send":var s=i(n,{type:t,timestamp:(new Date).getTime()});if(s.hasOwnProperty("tid")){l("https://3h4byzvmhh.execute-api.us-east-1.amazonaws.com/v1/collect?"+r(s))}}}}(window,document),csAnalytics=function(){function e(e,t){e=e||{},t=t||{};for(var o=Object.keys(t),n=0,s=o.length;n<s;n++)e[o[n]]=t[o[n]];return e}function t(){return n()&&window[window.GoogleAnalyticsObject]}function o(){return!!window._gaq}function n(){return!!window.GoogleAnalyticsObject}function s(e,t,o,n,s,a,c){e.GoogleAnalyticsObject=s,e[s]=e[s]||function(){(e[s].q=e[s].q||[]).push(arguments)},e[s].l=1*new Date,a=t.createElement(o),c=t.getElementsByTagName(o)[0],a.async=1,a.src=n,c.parentNode.insertBefore(a,c)}function a(){try{"function"==typeof csCollect&&csCollect.apply(this,arguments)}catch(e){console&&console.error(e)}try{if(n())if("function"==typeof arguments[0]){var e=arguments[0];t().call(this,function(){var t=ga.getByName(r);e.call(this,t)})}else"create"!=arguments[0]&&(arguments[0]=r+"."+arguments[0]),t().apply(this,arguments)}catch(e){console&&console.error(e)}}var c=!1,i=["onSourceSelected","onImportComplete","onBeforeDisplayContacts","onContactsSubmitted"],r="cloudsponge";return{init:function(e,t){function i(e){function o(e){var t,o,n=1;if(e)for(n=0,o=e.length-1;0<=o;o--)t=e.charCodeAt(o),n=(n<<6&268435455)+t+(t<<14),t=266338304&n,n=0!=t?n^t>>21:n;return n}return e=e||(new Date).valueOf().toString(),!!t&&(!t.hasOwnProperty("loadSampleRate")||o(e)%1e4<=100*t.loadSampleRate)}function l(){n()||o()||s(window,document,"script","//www.google-analytics.com/analytics.js","ga"),opts=e||{},opts.cookieDomain=opts.cookieDomain||"auto",t=t||{},r=opts.name,a("create",opts),a("set","dimension1",t.key),a("set","dimension2",t.version),a("set","appName",t.appName),a("set","appVersion",t.version),opts.alwaysSendReferrer&&a("set","referrer",window.location.toString()),t.loadPage&&(a("set","location",t.loadPage),a("set","title",t.title||"hidden"),i()&&csAnalytics.trackPage(t.loadPage,t.title||"hidden"))}c||(c=!0,t.shared&&"complete"!=document.readyState?window.addEventListener?window.addEventListener("load",function(){l()}):window.attachEvent&&window.attachEvent("onload",l):l())},trackPage:function(e,t){a("send","pageview",{title:t,page:e})},trackEvent:function(t,o){i.indexOf(t)<0||(o=e({eventCategory:"Widget",eventAction:t},o),"onSourceSelected"==o.eventAction?(a("set","dimension3",o.eventValue),delete o.eventValue):"onImportComplete"==o.eventAction?a("set","metric1",o.eventValue):"onBeforeDisplayContacts"==o.eventAction?o.eventValue?(o.eventValue=1,a("set","dimension4","share enabled")):(o.eventValue=0,
a("set","dimension4","share suppressed")):"onContactsSubmitted"==o.eventAction&&a("set","metric2",o.eventValue),a("send","event",o))}}}(),function(){function e(e){return void 0!==e&&null!==e}function t(e,t,o){e.addEventListener?e.addEventListener(t,o,!1):e.attachEvent&&e.attachEvent("on"+t,o)}function o(e){var t=document.getElementsByTagName("script")[0],o=null;return t&&(o=t.parentNode),o||(o=document.getElementsByTagName("body")[0]),o||(o=document.getElementsByTagName("head")[0]),o.appendChild(e)}function n(e){var t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("src",e),o(t)}function s(e){switch(function(e){return Object.prototype.toString.call(e).slice(8,-1)}(e)){case"Array":var t,o=new Array,n=e.length;for(t=0;t<n;t++)o[t]=s(e[t]);return o;case"Object":var a,o=new Object;for(a in e)o[a]=s(e[a]);return o;default:return e}}function c(e){var t,o={selectedEmail:function(){var e;if(null!==this.email&&"undefined"!=typeof this.email)for(e=0;e<this.email.length;e++)if(this.email[e].selected)return this.email[e].address;return this.primaryEmail&&this.primaryEmail()},primaryEmail:function(){return null!==this.email&&"undefined"!=typeof this.email&&null!==this.email[0]&&"undefined"!=typeof this.email[0]?this.email[0].address:""},fullName:function(){return(this.first_name||"")+" "+(this.last_name||"")}};for(t=0;t<e.length;t++)for(var n in o)n&&(e[t][n]=o[n]);return e}function i(e){var t;return e&&(t=e.replace(/^\s+/,"").replace(/\s+$/,""),t.length>0)?t:null}function r(e,t,o){return o===undefined&&(o=!1),o&&(e='"'+(i(e)||t)+'"'),i(e)?e+" <"+t+">":t}function l(e,t,o,n){o===undefined&&(o=", "),n===undefined&&(n=!1);var s,a,c=[];if(t.toString().indexOf("name")<0)for(s=0;s<e.length;s++)(a=e[s].selectedEmail())&&c.push(a);else for(s=0;s<e.length;s++)(a=e[s].selectedEmail())&&c.push(r(e[s].fullName(),a,n));return c.join(o)}function d(e){N.debug("Invoking Callback: "+e);var t=[].slice.apply(arguments).slice(1,arguments.length),o=null;if(z[e]!==undefined&&null!==z[e])try{o=z[e].apply(null,t)}catch(t){N.error("Attempt to invoke callback ["+e+"] failed: "+t.stack)}return o}function u(e,t){list_element=y(z[e]),list_element&&(list_element.value=t)}function p(e){e.setAttribute("data-cs-init",!0),e.getAttribute("href")||e.setAttribute("href","#cs_container"),e.onclick=function(){return csLaunch()}}function g(e,t){var o;"undefined"!=typeof onImportComplete?(o=l(e,t.include,",",!0),y(z.textarea_id)&&u("textarea_id",o),onImportComplete(o)):y(z.textarea_id)&&(o=l(e,t.include),u("textarea_id",o))}function f(){var e,t,o,n=document.getElementsByClassName("cs_import");for(e=0;e<n.length;e++)t=n[e],t.getAttribute("data-cs-init")||("div"==t.nodeName||"DIV"==t.nodeName?(link_visible=!0,o=document.createElement("a"),p(o),o.innerHTML="Add from Address Book",t.appendChild(o)):"a"!=t.nodeName&&"A"!=t.nodeName||(link_visible=!0,p(t)));var s=document.getElementsByTagName("body")[0];if(!y("cs_container")){var a=document.createElement("div");a.setAttribute("id","cs_container"),a.style.display="none",s.appendChild(a)}}function m(){if(j.updateOptions({options:z,version:cloudsponge.version}),j.getRpcLocation(function(e){A.apply(z,I.deconstructQueryString(e.search.substring(1))),L.completed("getRpcLocation")}),j.frameName(function(e){z.providerFrame=e,L.completed("frameName")}),f(),!y("cs_link")){a=document.createElement("a"),p(a),a.id="cs_link",a.style.display="none";document.getElementsByTagName("body")[0].appendChild(a)}L.completed("rpcReady")}function h(){var e=w+"/address_books/provider";"true"===cloudsponge.scriptLocation.queryParams.debug&&(e+="?debug=true"),link_visible=!1;try{var t={onReady:m,remote:e};z.easyXDM&&z.easyXDM.swf&&(t.swf=z.easyXDM.swf,t.remote=t.remote+"?swf="+encodeURI(z.easyXDM.swf)),j=new A.Rpc(t,{local:{getOptions:function(){return z},beforeImport:function(e,t){cloudsponge.trackPage("/loading","Loading Contacts"),d("__beforeImport",e,t),d("beforeImport",e,t)},afterImport:function(e,t,o){d("__afterImport",e,t,o),d("afterImport",e,t,o)},beforeDisplayContacts:function(e,t,o){var n=c(e);if(n){var a=s(n),i=d("beforeDisplayContacts",a,t,s(o));d("__beforeDisplayContacts",n,t,o,!1===i),cloudsponge.trackEvent("onImportComplete",{eventValue:n.length}),cloudsponge.trackEvent("onBeforeDisplayContacts",{eventValue:0!=i}),!1===i?(g(n,z),cloudsponge.end()):cloudsponge.trackPage("/share","Review and Share")}},afterSubmitContacts:function(e,t,o){cloudsponge.trackPage("/submitted","Submitted Contacts"),cloudsponge.trackEvent("onContactsSubmitted",{eventLabel:"Contacts Submitted",eventValue:e.length});var n=c(e);g(n,z),d("afterSubmitContacts",n,t,o),cloudsponge.end()},afterClose:function(){d("__afterClosing",null),d("afterClosing",null),cloudsponge.end()},closePopup:function(e){e(ie())},afterClosePopup:function(){d("afterClosingPopup",null),d("__afterClosingPopup",null)},resizeFrame:ne,_onUpdate:function(e){d("__onUpdate",e)},_onPageLoaded:function(e,t,o){cloudsponge._onLaunchedCallback&&cloudsponge._onLaunchedCallback.call(null,e,o),cloudsponge._onLaunchedCallback=null},_setFormAction:function(e){d("__setFormAction",e)}},remote:{updateOptions:{},unloadFrame:{},getRpcLocation:{},frameName:{},login:{},selectFile:{},getFileUpload:{},loadWidgetUrl:{},trackEvent:{},trackPage:{}}})}catch(e){N.error(e)}d("afterLoad")}function C(e){var t=y("cs_container_frame"),o=y("fbContentWrapper"),n=y("fbBox");t&&o&&n&&(e.width&&(o.style.width=t.style.width=e.width+"px"),e.height&&(o.style.height=t.style.height=e.height+"px"),e.top!==undefined&&null!==e.top&&(n.style.top=e.top+"px"),e.left!==undefined&&null!==e.left&&(n.style.left=e.left+"px"),window.scrollTo(0,window.scrollY))}function E(){var e=document;return Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))}function T(){return z.key||z.domain_key}function _(){W||window.JSON!==undefined||(n(w+"/assets/address_books/json2-fa80da7cd38bb47981bb45f0b7e4a3d4710ed53cb980f33f300162a5d69f8ecd.js"),W=!0),A!==undefined&&window.JSON!==undefined&&T()!==undefined?h():J++<Z?setTimeout(_,Q):A===undefined?N.error("Unable to load easyXDM, cannot initialize widget."):window.JSON===undefined?N.error("Unable to load JSON, cannot initialize widget."):T()===undefined?N.error("csOptions are not initialized. Please set the value of csOptions according to the documentation: https://www.cloudsponge.com/developer/#options"):N.error("Timed out while waiting for easyXDM to become ready.")}function v(){A.apply(me,z.floatbox),(z.force_mobile_render||z.mobile_render&&$)&&(window.onresize=ae,window.document.body.onorientationchange=ae,A.apply(me,he))}function S(t){var o=!0;return e(t)&&e(t.loadProvider)&&(o=t.loadProvider,delete t.loadProvider),o}function O(){return 1==z.inlineOauth||0==z.inlineOauth?z.inlineOauth:z.mobile}window.cloudsponge.easyXDM=window.easyXDM.noConflict("cloudsponge");var A=cloudsponge.easyXDM,b=!1,y=function(e){return"string"==typeof e?document.getElementById(e)||null:e},L=function(){function e(){G=!0,d("__afterInit"),d("afterInit"),x.length>0&&le.apply(this,x.pop())}function t(){var e;for(e in n)if(n.hasOwnProperty(e)&&!1===n[e])return!1;return!0}function o(){n.getRpcLocation=n.frameName=n.rpcReady=!1,s=[e]}var n={},s=[];return o(),{reset:o,completed:function(e){if(n[e]=!0,t())for(;s.length>0;)s.pop().call()}}}(),w=cloudsponge.scriptLocation.queryParams&&cloudsponge.scriptLocation.queryParams.origin||cloudsponge.scriptLocation.origin,I=function(){function e(e,t){return t?t+"["+e+"]":e}function t(o,n){var s=[],a=null;for(a in o)o[a]instanceof Function?s.push(e(a,n)+"=true"):o[a]instanceof Array?s.push(e(a,n)+"="+encodeURIComponent(o[a].join(","))):o[a]instanceof Object?s=s.concat(t(o[a],e(a,n))):"undefined"!=typeof o[a]&&s.push(e(a,n)+"="+encodeURIComponent(o[a]));return s}return{truncateLocaleData:function(e){return"object"==typeof e?JSON.stringify(e).substring(0,50):e},filterDefaultsFromArgs:function(arguments){var e={};for(var t in arguments)q[t]!=arguments[t]&&(e[t]="localeData"==t?this.truncateLocaleData(arguments[t]):arguments[t]);return e},constructQueryString:function(){var e,o={};for(e=0;e<arguments.length;e++)A.apply(o,this.filterDefaultsFromArgs(arguments[e]),!0);var n=t(o);return n=n.sort(function(e,t){return e.match(/^(key|domain_key|xdm_e|hostUrl|sig|timestamp)/)?-1:t.match(/^(key|domain_key|xdm_e|hostUrl|sig|timestamp)/)?1:0}),n.join("&")},deconstructQueryString:function(e){var t,o,n,s={};for("?"===e.charAt(0)&&(e=e.substr(1)),o=e.split("&"),t=0;t<o.length;t++)n=o[t].split("=",2),s[n[0]]=n[1];return s}}}(),U=function(){return{isMobile:function(){return navigator.userAgent&&navigator.userAgent.match(/Mobile/i)},isWebKit:function(){return navigator.userAgent&&navigator.userAgent.match(/ AppleWebKit\//i)},isAndroid:function(){return navigator.userAgent&&navigator.userAgent.match(/Android/i)}}}();!function(){A.DomHelper.requiresJSON(w+"/assets/address_books/json2-fa80da7cd38bb47981bb45f0b7e4a3d4710ed53cb980f33f300162a5d69f8ecd.js")}(),function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var o,n=this.length;for(o=t||0;o<n;o++)if(this[o]===e)return o;return-1}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)})}();var N=function(){function e(e,t){return"undefined"!=typeof A.Debug&&"undefined"!=typeof A.Debug.log&&!1!==A.Debug.log(e+": "+t)}return{debug:function(t){e("DEBUG",t)},warn:function(t){e("WARN",t)||"undefined"!=typeof window.console&&"undefined"!=typeof window.console.warn&&window.console.warn(t)},error:function(e){"undefined"!=typeof window.console&&"undefined"!=typeof window.console.error&&window.console.error(e)},info:function(t){e("INFO",t)}}}(),k=function(){var e=(new Date).getTime(),t=R+"="+(z[D]||z[R])+"&"+M+"="+e+"&"+B+"="+X;return z.sig=_csdigest.md5(t.toLowerCase()),z.timestamp=e,setTimeout(k,12e5),z.sig},R="domain_key",B="origin",M="nonce",D="key",P=["addressbook","aol","bol","csv","facebook","gmail","gmx","icloud","linkedin","mail126","mail163","mail2world","mail_ru","mail_yeah_net","mailcom","naver","office365","outlook","outlookcom","plaxo","poczta_o2","qip_ru","qq_mail","rediff","sapo","terra","uol","vcard","web_de","windowslive","yahoo","yandex_ru"],x=[];if(window.location){var H=/#?\(_cs_import=([^:]+):([^)]+)\)/,V=location.hash.match(H);V&&(cloudsponge.launching=!0,x.push([V[1],V[2]]),window.location.hash=window.location.hash.replace(H,""))}var W=!1,$=U.isMobile()&&U.isWebKit(),j=(U.isMobile()&&U.isAndroid(),null),G=!1,F=null,K=window.location.host,X=window.location.protocol+"//"+K,q={cache_contacts:!0,csvProviders:"{}",displaySelectAllNone:!0,include:["name","email"],initiallySelectedContacts:!1,inlineOauth:null,force_mobile_render:!1,mobile_render:!1,onlyGroupedContacts:!1,selectionLimit:null,selectionLimitMessage:null,sources:["gmail","yahoo","windowslive","aol","outlook","addressbook","plaxo"],performEmailValidation:!0,ignoreMultipleEmails:!1,selectAccount:!1,skipContactFilter:!1,skipSourceMenu:!1,display_branding:!0,stylesheet:null,textarea_id:null},Y={include:["name","email"],initiallySelectedContacts:!1,displaySelectAllNone:!0,skipSourceMenu:!1,mobile_render:!1,force_mobile_render:!1,display_branding:!0,cache_contacts:!0,csvProviders:{},floatbox:{},hostUrl:location.toString(),utmURL:function(){return"https://www.cloudsponge.com/address-book-widget/?utm_source="+K+"&utm_medium=cloudsponge-widget&utm_content=cloudsponge-logo&utm_campaign=powered-by-cloudsponge"}},z=A.apply({},Y);A.apply(z,{version:cloudsponge.version});var J=0,Q=250,Z=120,ee=function(){if(z.display_branding){var e=navigator.appVersion;if(parseInt(e.substr(e.indexOf("MSIE")+5),10)<7)return;var t=document.createElement("div");t.id="brand",z.utmURL?fb.setInnerHTML(t,'<span style="float:right;margin-top:20px;border:none;border-width:0;"><a href='+z.utmURL()+' target="_blank" rel="nofollow"><img alt="Powered_by-grey" onmouseout="this.src=\''+w+"/assets/address_books/powered_by-grey-97cf8cc16cc37a1f61524379939c7d258379ab40da01c50874652722536f7680.png'\" onmouseover=\"this.src='"+w+'/assets/address_books/powered_by-color-85f9355155de92d406776f9843beca58d6d90eb311d2082b7c4cd9f45608e118.png\'" src="'+w+'/assets/address_books/powered_by-grey-97cf8cc16cc37a1f61524379939c7d258379ab40da01c50874652722536f7680.png" style="border-width:0;" /></a></span><span style="float:right;color:white;font-size:10px;font-family:verdana;margin-top:23px;margin-right:10px">powered by</span>'):fb.setInnerHTML(t,'<span style="float:right;margin-top:20px;border:none;border-width:0;"><img alt="Powered_by-grey" onmouseout="this.src=\''+w+"/assets/address_books/powered_by-grey-97cf8cc16cc37a1f61524379939c7d258379ab40da01c50874652722536f7680.png'\" onmouseover=\"this.src='"+w+'/assets/address_books/powered_by-color-85f9355155de92d406776f9843beca58d6d90eb311d2082b7c4cd9f45608e118.png\'" src="'+w+'/assets/address_books/powered_by-grey-97cf8cc16cc37a1f61524379939c7d258379ab40da01c50874652722536f7680.png" style="border-width:0;" /></span><span style="float:right;color:white;font-size:10px;font-family:verdana;margin-top:23px;margin-right:10px">powered by</span>'),fb.fbBox.appendChild(t)}},te=function(){if(z.display_branding){var e=navigator.appVersion;if(parseInt(e.substr(e.indexOf("MSIE")+5),10)<7)return;y("brand").style.display="none"}},oe=function(){var e,o=window.document.createElement("iframe"),n=w+"/address_books";if(F&&(n=n+"/"+F.service+"/"+F.act),e=F&&F.query?F.query:I.constructQueryString(z,{deep:!1}),F=null,n=n+"?"+e,o.id=o.name="cs_container_frame",o.src=n,o.setAttribute("frameBorder","0"),o.style.width="100%",o.style.height="100%",z.__hiddenIframe&&(o.tabIndex=-1),t(o,"load",function(){se()}),z.widgetContainerId){var s=y(z.widgetContainerId);s&&s.appendChild(o)}else y("cs_container").appendChild(o);return!0},ne=function(e){var t=(y("fbOverlay"),E()),o=document.body.clientWidth;C({top:0,left:0,height:Math.max(e.height,t),width:Math.max(e.width,o)})},se=function(){var e,t;e=y("fbContentWrapper"),t=y("cs_container_frame"),e&&t&&(t.style.height=e.style.height)},ae=function(){C({top:0,left:0,width:document.body.clientWidth})},ce=function(){d("beforeClosing",null);var e=y("cs_container_frame");return e&&e.parentNode.removeChild(e),!0},ie=function(){var e=!!j.popup;try{j.popup&&!j.popup.closed&&(j.popup.close(),j.popup=null)}catch(e){}return e},re=function(e){ce(),j&&j.unloadFrame(),e||(cloudsponge.trackPage("/done","Closed Widget"),d("__afterClosing",null),d("afterClosing",null))},le=function(e,t,o){var n=null,s=null,a=null,c=!z.widgetContainerId;if(e||cloudsponge.trackPage("/choose","Choose Address Book"),!e&&window.csWidget)return csWidget.showPopup(),csWidget.showBooksTab(),!1;if(o||(o={}),F=null,z.mobile=cloudsponge.mobile||z.force_mobile_render,k(),G){if(delete cloudsponge.launching,!1!==d("beforeLaunch")){if(e&&t){var i=I.constructQueryString(A.apply(z,{import_token:t}));F={service:e.toLowerCase(),act:"import",query:i}}else if(e&&"undefined"!=typeof e.toLowerCase&&null!==e.toLowerCase&&(e=e.toLowerCase(),cloudsponge.trackEvent("onSourceSelected",{eventValue:e}),cloudsponge.trackPage("/connect","Authenticate"),-1!==P.indexOf(e))){switch(cloudsponge._onLaunchedCallback=o.__onLaunched||z.__onLaunched,F={service:e.toLowerCase(),act:"wait"},F.service){case"aol":s=520,n=420;break;case"facebook":s=420,n=400;break;case"gmail":s=420,n=640;break;case"office365":case"outlookcom":s=420,n=485;break;case"windowslive":s=470,n=600;break;case"yahoo":s=600,n=500;break;case"csv":case"linkedin":case"qq_mail":case"vcard":F.act="auth",z.csv=!0;break;default:F.act="auth"}if(n)if(a=w+"/address_books/"+e+"/auth?"+I.constructQueryString(z,{deep:!0}),O())window.location=a,c=!1;else{var r=window.outerWidth||document.documentElement.clientWidth,l=window.outerHeight||document.documentElement.clientHeight,u="undefined"==typeof window.screenY?window.screenTop:window.screenY,p="undefined"==typeof window.screenX?window.screenLeft:window.screenX,g=(r-s)/2+p,f=(l-n)/2+u;if(j.popup=window.open(a,"_csimport","height="+n+",width="+s+",left="+g+",top="+f+",scrollbars=1"),j.popup){try{j.popup.name="_csimport",j.popup.opener=window}catch(e){N.warn("Can't access popup attributes")}j.popup.location=a,j.popup.focus&&j.popup.focus()}else N.warn("No window returned when opening auth popup.")}}window.Floatbox&&c&&fb.start(y("cs_link")),oe()}}else x.push([e,t]);return!1};cloudsponge.launch=le;var de=function(){var e=j&&j.destroy,t=z.providerFrame&&window.frames[z.providerFrame];return!(!e||!t)},ue=function(){var e=y("cs_container_frame");e&&e.parentNode.removeChild(e)},pe=function(){if(ue(),j&&(j.popup&&j.popup.close(),j.destroy))try{j.destroy()}catch(e){}j=null,L.reset()},ge=function(e){de()||pe(),cloudsponge._onLaunchedCallback=null,A.apply(z,cloudsponge.config),A.apply(z,cloudsponge.initOptions),A.apply(z,window.csPageOptions),A.apply(z,e),z&&(z.key||z.domain_key)&&csAnalytics.init({trackingId:"UA-10218190-7",name:"cloudspongeHost",alwaysSendReferrer:!0},{key:z.key||z.domain_key,version:cloudsponge.version,appName:"CloudSponge Widget",loadPage:"/load",title:"Loaded Script",loadSampleRate:0,shared:!0}),k(),v();var t=S(window.csPageOptions);t=S(z)&&t,t&&T()?j?j.updateOptions({options:z,version:cloudsponge.version},function(){G&&(f(),d("__afterInit"),d("afterInit"))}):(G=!1,j=null,_()):(f(),d("__afterInit"),d("afterInit"))};cloudsponge.login=function(e){j.login(e)},cloudsponge.selectFile=function(e){j.selectFile(e)},cloudsponge.getFileUpload=function(e,t){j.getFileUpload(e,t)};var fe=function(e){b||(b=!0,window.fb&&window.fb.end?fb.end():re(e),b=!1)},me={type:"iframe",width:410,height:487,scrolling:"no",outerBorder:1,innerBorder:0,padding:20,disableScroll:!0,outsideClickCloses:!1,enableKeyboardNav:!1,controlsPos:"tr",resizeDuration:2.5,startAtClick:!1,afterItemStart:function(){ee(),se(),d("afterLaunch")},beforeBoxEnd:function(){re(),te()}},he={width:"100%",height:"100%",boxLeft:0,boxTop:0,roundCorners:"none",outerBorder:0,padding:0,panelPadding:0,shadowType:"none",shadowSize:0,showClose:!1,afterItemStart:function(){ne({height:y("cs_container_frame").clientHeight,width:y("cs_container_frame").clientWidth}),d("afterLaunch")},beforeBoxEnd:re};window.csLaunch=le,window.csInit=ge,window.fbPageOptions=me,A.whenReady(function(){(window.csPageOptions||window.cloudsponge.config)&&ge()}),window.cloudsponge.version||(window.cloudsponge.version="1.3.0"),A.apply(window.cloudsponge,{init:ge,end:fe,options:z,isMobileSafari:$,mobile:!!U.isMobile(),getRpc:function(){return j},trackPage:function(e,t){csAnalytics&&csAnalytics.trackPage(e,t),j.trackPage(e,t)},trackEvent:function(e,t){csAnalytics&&csAnalytics.trackEvent(e,t),j.trackEvent(e,t)},loadWidgetUrl:function(e){j.loadWidgetUrl(e)},removeIframe:ue,reset:pe})}(),!window.fb){var emptyFunc=function(){};window.fb={start:emptyFunc,fbBox:{appendChild:emptyFunc},setInnerHTML:emptyFunc}}(function(){window.cloudsponge&&window.fb&&(window.cloudsponge.fb=window.fb,window.cloudsponge.fb$=window.fb$)}).call(this),function(){cloudsponge.constants={defaultCSS:"/assets/address_books15-0af85784706069a23eeb5d934a0a084f717519114aa05ca06da385292c37ac11.css",themePaths:{"unresponsive-desktop":"/assets/themes/unresponsive-desktop-f78f65925b6e4f4f655836036a620d45f4f9e1b9d2cf91ee2739a4a4126d8fc7.css",frost:"/assets/themes/frost-0dc4ea35d5c646c51196a989d5721993761e1d603901e29e030fdca1e6b49063.css"},localePaths:{"pt-br":"/assets/pt-br-bf6aef81b3418d8bb7b478cf2967ac875a6b217b6f6749ba9cdf909ecd7339c2.json",bg:"/assets/bg-5e912abed85a3811ce9815a44d5c806db4c5cf8a6c9c1347cde748563637bd86.json",fr:"/assets/fr-50f17e64d3e9a35067d8d4ab17e1d1000eaddc7f9eb4af37e72a2f9f1539a27c.json"},trackingId:"UA-10218190-7",utmURL:function(){return"https://www.cloudsponge.com/address-book-widget/?utm_source="+window.location.host+"&utm_medium=cloudsponge-widget&utm_content=cloudsponge-logo&utm_campaign=powered-by-cloudsponge"}}}(),cloudspongeUI={},cloudspongeUI.controller=function(){return{init:function(e){cloudsponge.init(e)},realLaunch:function(e,t,o){cloudsponge.realLaunch(e,t,o)},launch:function(e,t,o){csWidget.launch(e,t,o)},end:function(){cloudsponge.end()},login:function(e){return cloudsponge.login(e)},getRpc:function(){return cloudsponge.getRpc()},loadWidgetUrl:function(e){return cloudsponge.loadWidgetUrl(e)},trackPage:function(e,t){return cloudsponge.trackPage(e,t)},trackEvent:function(e,t){return cloudsponge.trackEvent(e,t)},scriptLocation:cloudsponge.scriptLocation,constants:cloudsponge.constants,options:cloudsponge.options,removeIframe:cloudsponge.removeIframe}}();var CS_LOCALE={ADDRESS_BOOK:"Choose Your Address Book",AUTHORIZATION:"Authenticating",AUTHORIZATION_FOCUS:"Click here to authenticate",SIGN_IN:"Sign in",LOADING_CONTACTS:'<span class="cloudsponge-icon ${provider}"></span> ${name}',SEARCH_CONTACTS:"Search ${provider} contacts",SEARCH_SELECTED:"Search selected contacts",NO_SELECTED_CONTACTS:"There are no selected contacts",GET_CONTACTS:"Get ${0} contacts",GET_CONTACTS_MOBILE:"Next",SELECT_CONTACTS:"Select contacts",SELECT_ALL:"Select all (${0})",DESELECT_ALL:"Deselect all (${0})",SELECT_SEARCH:"Select result (${0})",DESELECT_SEARCH:"Deselect result (${0})",REVIEW_SELECTED:"Review Selected (${0})",BACK_TO_LIST:"Back to List",NO_SEARCH_RESULTS:"There are no matched contacts",MORE_MAILS:"+${0} more",MORE_PHONES:"+${0} more",DETAILS_TITLE:"Contact Details",DETAILS_EMAIL:"E-mail",DETAILS_PHONE:"Phone",SIGN_IN_ACCOUNT:"Sign in to your account",USERNAME:"Username",PASSWORD:"Password",ENTER_USERNAME:"Please enter your username",ENTER_PASSWORD:"Please enter your password",PRIVACY_NOTICE:"Privacy Notice",PRIVACY_DISCLAIMER:"We do not store your email address or password information. Your information is submitted securely to retrieve your address book.",IMPORT_CONTACTS:"Import Your Contacts",GET_CSV_CONTACTS:"Get Your ${name} Contacts",EXPORT_CSV:"Click above to export and download your contacts to your computer.<br> You may have to sign in to your account.",DRAG_FILES:"Select and upload your contacts file ",DROP_FILES:"Click to upload your contacts",CHOICE_ANOTHER:"Want to choose another address book?",CLICK_HERE:"click here",NOT_SUPPORTED:"${name} requires contacts upload in CSV file format.<br> This feature is currently supported on our desktop version only.",SELECTION_LIMIT:"Sorry, you cannot select more contacts",DESELECT_CONFIRM:"Are you sure you want to deselect all contacts?",SUGGESTIONS:"Suggestions",STORAGE_LOGGED_AS:"Displaying contacts for ${0}",STORAGE_LAST_UPDATE:"Last updated: ${0}",STORAGE_ENABLED_STATUS:"Caching contacts is enabled",STORAGE_BT_UPDATE_NOW:"Update now",STORAGE_BT_DISABLE_CACHE:"Disable caching",STORAGE_DISABLED_STATUS:"Caching contacts is disabled",STORAGE_BT_ENABLE_CACHE:"Enable caching",UNABLE_LOAD_CONTACTS:'Unable to load ${name} contacts. ${error_message} <br> <a href="javascript:void(0)" id="cloudsponge-error-tryagain">Please try again</a>.',ERROR_258:"<br>Timeout occurred.",ERROR_259:"<br>Username and password are required.",ERROR_262:"<br>The same import failed to authenticate recently.",ERROR_263:"<br>Username and password do not match.",ERROR_264:"<br>The address book is temporarily unavailable, please try again later.",ERROR_265:"<br>This account has been canceled.",ERROR_266:"<br>The account has been blocked. Reset the password to reenable it.",ERROR_267:"<br>Terms of Service have changed for your account. Sign in to your account to enable it.",ERROR_514:"<br>Consent was not given to access your contacts or consent was revoked.",ERROR_516:"<br>Consent was not granted within the allotted time.",ERROR_518:"<br>Unable to communicate successfully with the address book provider.",ERROR_528:"<br>Unable to retrieve contacts. New Yahoo! users must wait 14 days to use this feature.",ERROR_544:"<br>The Gmail developer account is not configured to be able to access the Contacts API.<br>Please review the custom branding.",ERROR_769:"<br>You must trust the applet to import your contacts.",ERROR_770:"<br>No supported contact source was detected on your system.",ERROR_771:"<br>Failed posting contacts to the server.",ERROR_772:"<br>The Desktop Applet was not trusted within the allotted time.",ERROR_774:"<br>You must allow access to Microsoft Outlook to import your contacts. ",ERROR_775:"<br>The application was denied access to Contacts by the OS.",ERROR_1025:"<br>You must upload a valid file.",ERROR_1026:"<br>The file uploaded did not match a valid format.",ERROR_1027:"<br/>File uploads are not supported on the device.",ERROR_UNEXPECTED:"<br>An unexpected error occurred while importing your contacts.",ERROR_RESTART:"<br>Start Over",ERROR_CLOSE:"<br>Dismiss",ERROR_CLOSE:"<br>Dismiss",ERROR_10:"<br>HTTP Basic: Access denied. Please check your credentials.",ICLOUD_TWO_STEPS_VERIF:'<strong>Using app-specific passwords</strong><br/>When your Apple ID is protected with two-step verification, or\xa0two-factor authentication, you\'ll need to use an app-specific password to sign in to your account using any apps or services that don\'t support entering verification\xa0codes.<br/>Generate an app-specific password: <a href="https://appleid.apple.com/account/manage" target="_blank">Sign in to your\xa0Apple ID account page</a>.  Follow the steps on your screen.<br/>After you generate your app-specific password, enter or paste it into the password field of the app as you would normally.<br/><a href="https://support.apple.com/HT204397" target="_blank">Learn more about app-specific passwords</a>.'};cloudspongeUI.cs_locale=CS_LOCALE;var csWidgetTemplate={getBase:function(){var e=[];return e.push('<div id="cloudsponge-overlay"></div>','<div id="cloudsponge-address-book">',"${0}"),cloudspongeUI.controller.options._hideBranding||e.push('<div class="cloudsponge-copyright">powered by <a href="'+cloudspongeUI.controller.options.utmURL()+'" target="_blank" rel="nofollow"><span>CloudSponge</span></a></div>'),e.push("</div>"),e.join("")},getLoadingTab:function(){var e=[];return e.push('<div id="cloudsponge-loading-tab" class="cloudsponge-widget">','<div class="cloudsponge-topbar">','<a class="cloudsponge-button cloudsponge-back-button" href="javascript:void(0)">','<em class="cloudsponge-glyph back-arrow"></em>',"</a>",'<div class="cloudsponge-h1">${title}</div>','<a class="cloudsponge-close-button" href="javascript:void(0)"><em class="cloudsponge-glyph cross"></em></a>',"</div>",'<div id="cloudsponge-loading-overlay">','<em id="cloudsponge-loader">','<span id="cloudsponge-loader-text" class="cloudsponge-loading-text"></span>','<span id="cloudsponge-loading-gif" class="cloudsponge-loading-gif"></span>','<span id="cloudsponge-oauth-focus-span"><a id="cloudsponge-oauth-focus" href="javascript:void(0)">${oauthFocus}</a></span>',"</em>","</div>","</div>"),e.join("")},getLoginTab:function(){var e=[];return e.push('<div id="cloudsponge-login-tab" class="cloudsponge-widget">','<div class="cloudsponge-topbar">','<a class="cloudsponge-button cloudsponge-back-button" href="javascript:void(0)">','<em class="cloudsponge-glyph back-arrow"></em>',"</a>",'<div class="cloudsponge-h1">${title}</div>','<a class="cloudsponge-close-button" href="javascript:void(0)"><em class="cloudsponge-glyph cross"></em></a>',"</div>",'<div class="cloudsponge-login">','<form id="cloudsponge-login-form" class="cloudsponge-login-form" action="" target="cs_container_frame" method="post">','<div class="cloudsponge-h2">','<em id="cloudsponge-source-icon" class="cloudsponge-icon"></em> <em id="cloudsponge-source-name"></em>',"<span>${signInAccount}</span>","</div>",'<p id="cloudsponge-login-error" class="cloudsponge-error"></p>','<p><input id="cloudsponge-login-user" type="text" name="user" placeholder="${username}"></p>','<p><input id="cloudsponge-login-password" type="password" name="pass" placeholder="${password}"></p>',"<p>",'<input id="cloudsponge-source-value" type="hidden" name="source">','<input type="submit" value="${signIn}">',"</p>",'<p id="cloudsponge-icloud-two-steps-verification-message" style="display:none">${icloud_two_steps_verif}</p>','<p id="cloudsponge-login-back">',"${choiceAnother}<br>",'<a href="javascript:void(0)" class="cloudsponge-desktop-back-button">${clickHere}</a>',"</p>","</form>",'<p class="cloudsponge-disclaimer">',"<span>${privacyNotice}</span>","${privacyDisclaimer}","</p>","</div>","</div>"),e.join("")},getImportTab:function(){var e=[];return e.push('<div id="cloudsponge-import-tab" class="cloudsponge-widget">','<div class="cloudsponge-topbar">','<a class="cloudsponge-button cloudsponge-back-button" href="javascript:void(0)">','<em class="cloudsponge-glyph back-arrow"></em>',"</a>",'<div class="cloudsponge-h1">${title}</div>','<a class="cloudsponge-close-button" href="javascript:void(0)"><em class="cloudsponge-glyph cross"></em></a>',"</div>",'<div class="cloudsponge-import">','<form id="cloudsponge-import-form" class="cloudsponge-import-form" action="" method="POST" enctype="multipart/form-data">','<div class="cloudsponge-csv-generic" style="display:none;">','<em id="cloudsponge-provider-icon-generic" class="cloudsponge-csv-generic cloudsponge-provider cloudsponge-icon csv"></em>',"</div>",'<div class="cloudsponge-step-row cloudsponge-csv-specific">','<span class="cloudsponge-step-number">1</span>','<a id="cloudsponge-csv-export" class="cloudsponge-save-button" target="_blank" rel="noopener" href="javascript:void(0)"><em id="cloudsponge-csv-icon" class="cloudsponge-icon"></em> <span id="cloudsponge-csv-contacts"></span></a>',"<p>${exportCSV}</p>","</div>",'<div class="cloudsponge-step-row">','<span class="cloudsponge-step-number cloudsponge-csv-specific">2</span>',"<p>${dragFiles}</p>",'<div id="cloudsponge-file-upload" class="cloudsponge-file-upload">',"${dropFiles}","</div>",'<input id="cloudsponge-file-upload-input" type="file" name="csv_file" accept="text/csv|text/vcard">',"</div>",'<div id="cloudsponge-import-back" class="cloudsponge-step-row cloudsponge-description">','${choiceAnother} <a class="cloudsponge-desktop-back-button" href="javascript:void(0)">${goBack}</a>',"</div>",'<div class="cloudsponge-not-supported" id="cloudsponge-csv-not-supported">',"</div>","</form>","</div>","</div>"),e.join("")},getAddressBooksTab:function(){var e=[];return e.push('<div id="cloudsponge-books-tab" class="cloudsponge-widget">','<div class="cloudsponge-topbar">','<a class="cloudsponge-button cloudsponge-back-button cloudsponge-back-close" href="javascript:void(0)">','<em class="cloudsponge-glyph back-arrow"></em>',"</a>",'<div class="cloudsponge-h1">${title}</div>','<a class="cloudsponge-close-button" href="javascript:void(0)"><em class="cloudsponge-glyph cross"></em></a>',"</div>",'<div class="cloudsponge-providers-holder">','<ul id="cloudsponge-providers-list" class="cloudsponge-providers-list">',"${items}","</ul>","</div>","</div>"),e.join("")},getBooksEntry:function(){return'<li class="${addClass}" data-launcher="${launcher}"><a href="javascript:void(0)"><em class="cloudsponge-icon ${className}"></em> ${name}</a></li>'},getContactsManagerTab:function(){var e=[]
;return e.push('<div id="cloudsponge-contacts-tab" class="cloudsponge-widget">','<div class="cloudsponge-topbar">','<a class="cloudsponge-button cloudsponge-back-button" href="javascript:void(0)">','<em class="cloudsponge-glyph back-arrow"></em>',"</a>",'<div class="cloudsponge-h1">${title}</div>','<a class="cloudsponge-close-button" href="javascript:void(0)"><em class="cloudsponge-glyph cross"></em></a>',"</div>",'<div id="cloudsponge-contacts-manager">','<div id="cloudsponge-search-bar" class="cloudsponge-header">','<div class="cloudsponge-input-holder">','<em id="cloudsponge-provider-icon" data-base-class="cloudsponge-provider cloudsponge-icon"></em>','<em class="cloudsponge-separator"></em>','<em class="cloudsponge-glyph search"></em>','<input id="cloudsponge-search-contacts" type="text" class="cloudsponge-input" placeholder="${search_contacts}">','<input id="cloudsponge-search-booked" type="text" class="cloudsponge-input" placeholder="${search_selected}">','<a id="cloudsponge-contacts-search-close" class="cloudsponge-close-search" href="javascript:void(0)">','<em class="cloudsponge-glyph cross"></em>',"</a>",'<a id="cloudsponge-booked-search-close" class="cloudsponge-close-search" href="javascript:void(0)">','<em class="cloudsponge-glyph cross"></em>',"</a>","</div>","</div>",'<div id="cloudsponge-contacts-title" class="cloudsponge-title">','<a id="cloudsponge-select-all" class="cloudsponge-left-link" href="javascript:void(0)">${select_all}</a>','<a id="cloudsponge-deselect-all" class="cloudsponge-left-link" href="javascript:void(0)">${deselect_all}</a>','<a id="cloudsponge-select-search" class="cloudsponge-left-link" href="javascript:void(0)">${select_search}</a>','<a id="cloudsponge-deselect-search" class="cloudsponge-left-link" href="javascript:void(0)">${deselect_search}</a>','<a id="cloudsponge-review-booked" href="javascript:void(0)">${review_booked}</a>','<a id="cloudsponge-back-to-list" href="javascript:void(0)">${back_to_list}</a>',"</div>",'<div class="cloudsponge-contacts-content">','<div class="cloudsponge-cell">','<div class="cloudsponge-cell-holder">','<div id="cloudsponge-contacts-scrolling-region">','<div id="cloudsponge-no-search-results" class="cloudsponge-message">${no_search_results}</div>','<div id="cloudsponge-no-selected-contacts" class="cloudsponge-message">${no_selected_contacts}</div>','<ul id="cloudsponge-contacts-list" class="cloudsponge-contacts-list"></ul>','<div class="cloudsponge-storage-message"></div>','<div class="cloudsponge-copyright-item"></div>',"</div>",'<div id="cloudsponge-dictionary" class="cloudsponge-dictionary">',"${dict_items}","</div>",'<em id="cloudsponge-letter-preview" class="cloudsponge-letter-preview"></em>',"</div>","</div>","</div>",'<a id="cloudsponge-export-button" class="cloudsponge-button cloudsponge-export-button" href="javascript:void(0)">','<span id="cloudsponge-get-contacts" class="cloudsponge-desktop-export">${get_contacts}</span> ','<span id="cloudsponge-get-contacts-mobile" class="cloudsponge-mobile-export test">${get_contacts_mobile}</span>','<em class="cloudsponge-glyph forward-arrow"></em>',"</a>","</div>","</div>"),e.join("")},getMoreButton:function(){var e=[];return e.push('<div data-type="more" class="cloudsponge-js-more cloudsponge-mobile-detail">','<div class="cloudsponge-mobile-detail-more"></div>',"</div>"),e.join("")},getContact:function(){var e=[];return e.push("<li ",'data-index="${index}" ','data-type="contact"',' class="cloudsponge-contact-item ${class_name} ${unknown_class}"',">","${more_button}"),cloudspongeUI.controller.options.displayContactsColumns&&-1!==cloudspongeUI.controller.options.displayContactsColumns.indexOf("phone")&&e.push("<select ${disabled}>","${OPTION_PHONE}","</select>"),e.push("<select ${disabled}>","${OPTION_EMAIL}","</select>"),e.push('<div class="cloudsponge-row-container">','<input ${checked} id="contact-${index}" type="checkbox">','<label for="contact-${index}" class="cloudsponge-glyph cloudsponge-checkbox"></label>','<span class="cloudsponge-contact-avatar">${avatar}</span>','<div class="cloudsponge-h3">${name}</div>','<span class="cloudsponge-selected-mail ${multiple_class}">','<span class="cloudsponge-mail-label" title=${email}>${formatted_email}</span>','<em class="cloudsponge-glyph down-arrow"></em>','<em class="cloudsponge-more-mails">${plus_contacts}</em>','<ul class="cloudsponge-mail-dropdown">',"${CONTACT_EMAIL}","</ul>","</span>"),cloudspongeUI.controller.options.displayContactsColumns&&-1!==cloudspongeUI.controller.options.displayContactsColumns.indexOf("phone")&&e.push('<span class="cloudsponge-selected-phone ${multiple_phone_class}">','<span class="cloudsponge-phone-label" title="${phone}">${phone}</span>','<em class="cloudsponge-glyph down-arrow"></em>','<em class="cloudsponge-more-phones">${plus_phone}</em>','<ul class="cloudsponge-phone-dropdown">',"${CONTACT_PHONE}","</ul>","</span>"),e.push("</div>","</li>"),e.join("")},getCopyright:function(){var e=[];return cloudspongeUI.controller.options._hideBranding||e.push('<a href="'+cloudspongeUI.controller.options.utmURL()+'" target="_blank" rel="nofollow">Powered by CloudSponge</a>'),e.join("")},getLetter:function(){var e=[];return e.push('<li id="cloudsponge-letter-${letter}" class="cloudsponge-letter">',"${letter}","</li>"),e.join("")},getEmail:function(){var e=[];return e.push("<li",' data-type="option"',' data-mail="${email}"',' data-index="${index}"',">","${email}","</li>"),e.join("")},getOptionEmail:function(){var e=[];return e.push("<option"," ${selected}",' data-mail="${email}"',' data-primary="${primary}"',' data-type="${type}"',' data-index="${index}"',">","${email}","</option>"),e.join("")},getPhone:function(){var e=[];return e.push("<li",' data-type="option"',' data-phone="${phone}"',' data-index="${index}"',">","${phone}","</li>"),e.join("")},getOptionPhone:function(){var e=[];return e.push("<option"," ${selected}",' data-phone="${phone}"',' data-type="${type}"',' data-index="${index}"',">","${phone}","</option>"),e.join("")},getDictionary:function(){for(var e=[],t=[],o="A".charCodeAt(),n=0;n<26;n++)t.push(String.fromCharCode(n+o));t.push("#");for(var n=0,s=t.length;n<s;n++)e.push('<a href="javascript:void(0)" data-for="cloudsponge-letter-'+t[n].toLowerCase()+'">'+t[n]+"</a>");return e.join("")},getStorageMessage:function(){return html=[],html.push('<div id="cloudsponge-storage-logged-user">${logged_as}</div>','<div id="cloudsponge-storage-last-updated">',"${last_update}",'<a href="javascript:void(0)" id="cloudsponge-storage-update">${update_now}</a>',"</div>",'<div id="cloudsponge-storage-status-enabled">',"${storage_enabled_status}",'<a href="javascript:void(0)" id="cloudsponge-storage-disable">${disable_cache}</a>',"</div>",'<div id="cloudsponge-storage-status-disabled">',"${storage_disabled_status}",'<a href="javascript:void(0)" id="cloudsponge-storage-enable">${enable_cache}</a>',"</div>"),html.join("")},getContactDetails:function(){return html=[],html.push('<div id="cloudsponge-details-tab" class="cloudsponge-widget">','<div class="cloudsponge-topbar">','<a class="cloudsponge-button cloudsponge-back-button" href="javascript:void(0)">','<em class="cloudsponge-glyph back-arrow"></em>',"</a>",'<div class="cloudsponge-h1">${title}</div>','<a class="cloudsponge-close-button" href="javascript:void(0)"><em class="cloudsponge-glyph cross"></em></a>',"</div>",'<div class="cloudsponge-contact-details">','<div class="cloudsponge-h3">${name}</div>','<div class="cloudsponge-details">','<div class="cloudsponge-email-field">','<div class="cloudsponge-field-label">',"<label>${email_label}</label>","</div>",'<div class="cloudsponge-field-select">','<select class="cloudsponge-email-select" data-index=${id}>',"${OPTION_EMAIL}","</select>","</div>","</div>"),cloudsponge.options.displayContactsColumns&&-1!==cloudsponge.options.displayContactsColumns.indexOf("phone")&&html.push('<div class="cloudsponge-phone-field">','<div class="cloudsponge-field-label">',"<label>${phone_label}</label>","</div>",'<div class="cloudsponge-field-select">','<select class="cloudsponge-phone-select" data-index=${id}>',"${OPTION_PHONE}","</select>","</div>","</div>","</div>"),html.push("</div>","</div>"),html.join("")}};cloudspongeUI.widget_template=csWidgetTemplate;var csContactsTemplate={getName:function(){var e=[];return e.push("${name}"),e.join("")},getEmail:function(){var e=[];return e.push("${email}"),e.join("")},getNameEmail:function(){var e=[];return e.push("${name} <${email}>"),e.join("")},getNamePhone:function(){var e=[];return e.push("${name}: ${phone}"),e.join("")},getNameEmailPhone:function(){var e=[];return e.push("${name} <${email}>: ${phone}"),e.join("")},getNameEmailAddress:function(){var e=[];return e.push("${name} <${email}>: ${address}"),e.join("")}};cloudspongeUI.contacts_template=csContactsTemplate;var csUtils=function(){var e=function(){var e,t,o,n=[{base:"A",letters:"A\u24b6\uff21\xc0\xc1\xc2\u1ea6\u1ea4\u1eaa\u1ea8\xc3\u0100\u0102\u1eb0\u1eae\u1eb4\u1eb2\u0226\u01e0\xc4\u01de\u1ea2\xc5\u01fa\u01cd\u0200\u0202\u1ea0\u1eac\u1eb6\u1e00\u0104\u023a\u2c6f"},{base:"AA",letters:"\ua732"},{base:"AE",letters:"\xc6\u01fc\u01e2"},{base:"AO",letters:"\ua734"},{base:"AU",letters:"\ua736"},{base:"AV",letters:"\ua738\ua73a"},{base:"AY",letters:"\ua73c"},{base:"B",letters:"B\u24b7\uff22\u1e02\u1e04\u1e06\u0243\u0182\u0181"},{base:"C",letters:"C\u24b8\uff23\u0106\u0108\u010a\u010c\xc7\u1e08\u0187\u023b\ua73e"},{base:"D",letters:"D\u24b9\uff24\u1e0a\u010e\u1e0c\u1e10\u1e12\u1e0e\u0110\u018b\u018a\u0189\ua779"},{base:"DZ",letters:"\u01f1\u01c4"},{base:"Dz",letters:"\u01f2\u01c5"},{base:"E",letters:"E\u24ba\uff25\xc8\xc9\xca\u1ec0\u1ebe\u1ec4\u1ec2\u1ebc\u0112\u1e14\u1e16\u0114\u0116\xcb\u1eba\u011a\u0204\u0206\u1eb8\u1ec6\u0228\u1e1c\u0118\u1e18\u1e1a\u0190\u018e"},{base:"F",letters:"F\u24bb\uff26\u1e1e\u0191\ua77b"},{base:"G",letters:"G\u24bc\uff27\u01f4\u011c\u1e20\u011e\u0120\u01e6\u0122\u01e4\u0193\ua7a0\ua77d\ua77e"},{base:"H",letters:"H\u24bd\uff28\u0124\u1e22\u1e26\u021e\u1e24\u1e28\u1e2a\u0126\u2c67\u2c75\ua78d"},{base:"I",letters:"I\u24be\uff29\xcc\xcd\xce\u0128\u012a\u012c\u0130\xcf\u1e2e\u1ec8\u01cf\u0208\u020a\u1eca\u012e\u1e2c\u0197"},{base:"J",letters:"J\u24bf\uff2a\u0134\u0248"},{base:"K",letters:"K\u24c0\uff2b\u1e30\u01e8\u1e32\u0136\u1e34\u0198\u2c69\ua740\ua742\ua744\ua7a2"},{base:"L",letters:"L\u24c1\uff2c\u013f\u0139\u013d\u1e36\u1e38\u013b\u1e3c\u1e3a\u0141\u023d\u2c62\u2c60\ua748\ua746\ua780"},{base:"LJ",letters:"\u01c7"},{base:"Lj",letters:"\u01c8"},{base:"M",letters:"M\u24c2\uff2d\u1e3e\u1e40\u1e42\u2c6e\u019c"},{base:"N",letters:"N\u24c3\uff2e\u01f8\u0143\xd1\u1e44\u0147\u1e46\u0145\u1e4a\u1e48\u0220\u019d\ua790\ua7a4"},{base:"NJ",letters:"\u01ca"},{base:"Nj",letters:"\u01cb"},{base:"O",letters:"O\u24c4\uff2f\xd2\xd3\xd4\u1ed2\u1ed0\u1ed6\u1ed4\xd5\u1e4c\u022c\u1e4e\u014c\u1e50\u1e52\u014e\u022e\u0230\xd6\u022a\u1ece\u0150\u01d1\u020c\u020e\u01a0\u1edc\u1eda\u1ee0\u1ede\u1ee2\u1ecc\u1ed8\u01ea\u01ec\xd8\u01fe\u0186\u019f\ua74a\ua74c"},{base:"OI",letters:"\u01a2"},{base:"OO",letters:"\ua74e"},{base:"OU",letters:"\u0222"},{base:"OE",letters:"\x8c\u0152"},{base:"oe",letters:"\x9c\u0153"},{base:"P",letters:"P\u24c5\uff30\u1e54\u1e56\u01a4\u2c63\ua750\ua752\ua754"},{base:"Q",letters:"Q\u24c6\uff31\ua756\ua758\u024a"},{base:"R",letters:"R\u24c7\uff32\u0154\u1e58\u0158\u0210\u0212\u1e5a\u1e5c\u0156\u1e5e\u024c\u2c64\ua75a\ua7a6\ua782"},{base:"S",letters:"S\u24c8\uff33\u1e9e\u015a\u1e64\u015c\u1e60\u0160\u1e66\u1e62\u1e68\u0218\u015e\u2c7e\ua7a8\ua784"},{base:"T",letters:"T\u24c9\uff34\u1e6a\u0164\u1e6c\u021a\u0162\u1e70\u1e6e\u0166\u01ac\u01ae\u023e\ua786"},{base:"TZ",letters:"\ua728"},{base:"U",letters:"U\u24ca\uff35\xd9\xda\xdb\u0168\u1e78\u016a\u1e7a\u016c\xdc\u01db\u01d7\u01d5\u01d9\u1ee6\u016e\u0170\u01d3\u0214\u0216\u01af\u1eea\u1ee8\u1eee\u1eec\u1ef0\u1ee4\u1e72\u0172\u1e76\u1e74\u0244"},{base:"V",letters:"V\u24cb\uff36\u1e7c\u1e7e\u01b2\ua75e\u0245"},{base:"VY",letters:"\ua760"},{base:"W",letters:"W\u24cc\uff37\u1e80\u1e82\u0174\u1e86\u1e84\u1e88\u2c72"},{base:"X",letters:"X\u24cd\uff38\u1e8a\u1e8c"},{base:"Y",letters:"Y\u24ce\uff39\u1ef2\xdd\u0176\u1ef8\u0232\u1e8e\u0178\u1ef6\u1ef4\u01b3\u024e\u1efe"},{base:"Z",letters:"Z\u24cf\uff3a\u0179\u1e90\u017b\u017d\u1e92\u1e94\u01b5\u0224\u2c7f\u2c6b\ua762"},{base:"a",letters:"a\u24d0\uff41\u1e9a\xe0\xe1\xe2\u1ea7\u1ea5\u1eab\u1ea9\xe3\u0101\u0103\u1eb1\u1eaf\u1eb5\u1eb3\u0227\u01e1\xe4\u01df\u1ea3\xe5\u01fb\u01ce\u0201\u0203\u1ea1\u1ead\u1eb7\u1e01\u0105\u2c65\u0250"},{base:"aa",letters:"\ua733"},{base:"ae",letters:"\xe6\u01fd\u01e3"},{base:"ao",letters:"\ua735"},{base:"au",letters:"\ua737"},{base:"av",letters:"\ua739\ua73b"},{base:"ay",letters:"\ua73d"},{base:"b",letters:"b\u24d1\uff42\u1e03\u1e05\u1e07\u0180\u0183\u0253"},{base:"c",letters:"c\u24d2\uff43\u0107\u0109\u010b\u010d\xe7\u1e09\u0188\u023c\ua73f\u2184"},{base:"d",letters:"d\u24d3\uff44\u1e0b\u010f\u1e0d\u1e11\u1e13\u1e0f\u0111\u018c\u0256\u0257\ua77a"},{base:"dz",letters:"\u01f3\u01c6"},{base:"e",letters:"e\u24d4\uff45\xe8\xe9\xea\u1ec1\u1ebf\u1ec5\u1ec3\u1ebd\u0113\u1e15\u1e17\u0115\u0117\xeb\u1ebb\u011b\u0205\u0207\u1eb9\u1ec7\u0229\u1e1d\u0119\u1e19\u1e1b\u0247\u025b\u01dd"},{base:"f",letters:"f\u24d5\uff46\u1e1f\u0192\ua77c"},{base:"g",letters:"g\u24d6\uff47\u01f5\u011d\u1e21\u011f\u0121\u01e7\u0123\u01e5\u0260\ua7a1\u1d79\ua77f"},{base:"h",letters:"h\u24d7\uff48\u0125\u1e23\u1e27\u021f\u1e25\u1e29\u1e2b\u1e96\u0127\u2c68\u2c76\u0265"},{base:"hv",letters:"\u0195"},{base:"i",letters:"i\u24d8\uff49\xec\xed\xee\u0129\u012b\u012d\xef\u1e2f\u1ec9\u01d0\u0209\u020b\u1ecb\u012f\u1e2d\u0268\u0131"},{base:"j",letters:"j\u24d9\uff4a\u0135\u01f0\u0249"},{base:"k",letters:"k\u24da\uff4b\u1e31\u01e9\u1e33\u0137\u1e35\u0199\u2c6a\ua741\ua743\ua745\ua7a3"},{base:"l",letters:"l\u24db\uff4c\u0140\u013a\u013e\u1e37\u1e39\u013c\u1e3d\u1e3b\u017f\u0142\u019a\u026b\u2c61\ua749\ua781\ua747"},{base:"lj",letters:"\u01c9"},{base:"m",letters:"m\u24dc\uff4d\u1e3f\u1e41\u1e43\u0271\u026f"},{base:"n",letters:"n\u24dd\uff4e\u01f9\u0144\xf1\u1e45\u0148\u1e47\u0146\u1e4b\u1e49\u019e\u0272\u0149\ua791\ua7a5"},{base:"nj",letters:"\u01cc"},{base:"o",letters:"o\u24de\uff4f\xf2\xf3\xf4\u1ed3\u1ed1\u1ed7\u1ed5\xf5\u1e4d\u022d\u1e4f\u014d\u1e51\u1e53\u014f\u022f\u0231\xf6\u022b\u1ecf\u0151\u01d2\u020d\u020f\u01a1\u1edd\u1edb\u1ee1\u1edf\u1ee3\u1ecd\u1ed9\u01eb\u01ed\xf8\u01ff\u0254\ua74b\ua74d\u0275"},{base:"oi",letters:"\u01a3"},{base:"ou",letters:"\u0223"},{base:"oo",letters:"\ua74f"},{base:"p",letters:"p\u24df\uff50\u1e55\u1e57\u01a5\u1d7d\ua751\ua753\ua755"},{base:"q",letters:"q\u24e0\uff51\u024b\ua757\ua759"},{base:"r",letters:"r\u24e1\uff52\u0155\u1e59\u0159\u0211\u0213\u1e5b\u1e5d\u0157\u1e5f\u024d\u027d\ua75b\ua7a7\ua783"},{base:"s",letters:"s\u24e2\uff53\xdf\u015b\u1e65\u015d\u1e61\u0161\u1e67\u1e63\u1e69\u0219\u015f\u023f\ua7a9\ua785\u1e9b"},{base:"t",letters:"t\u24e3\uff54\u1e6b\u1e97\u0165\u1e6d\u021b\u0163\u1e71\u1e6f\u0167\u01ad\u0288\u2c66\ua787"},{base:"tz",letters:"\ua729"},{base:"u",letters:"u\u24e4\uff55\xf9\xfa\xfb\u0169\u1e79\u016b\u1e7b\u016d\xfc\u01dc\u01d8\u01d6\u01da\u1ee7\u016f\u0171\u01d4\u0215\u0217\u01b0\u1eeb\u1ee9\u1eef\u1eed\u1ef1\u1ee5\u1e73\u0173\u1e77\u1e75\u0289"},{base:"v",letters:"v\u24e5\uff56\u1e7d\u1e7f\u028b\ua75f\u028c"},{base:"vy",letters:"\ua761"},{base:"w",letters:"w\u24e6\uff57\u1e81\u1e83\u0175\u1e87\u1e85\u1e98\u1e89\u2c73"},{base:"x",letters:"x\u24e7\uff58\u1e8b\u1e8d"},{base:"y",letters:"y\u24e8\uff59\u1ef3\xfd\u0177\u1ef9\u0233\u1e8f\xff\u1ef7\u1e99\u1ef5\u01b4\u024f\u1eff"},{base:"z",letters:"z\u24e9\uff5a\u017a\u1e91\u017c\u017e\u1e93\u1e95\u01b6\u0225\u0240\u2c6c\ua763"}],s={};for(t=0;t<n.length;t++)for(e=n[t].letters,o=0;o<e.length;o++)s[e[o]]=n[t].base;return s}();return{getOption:function(e){if("undefined"!=typeof cloudspongeUI.controller.options)return cloudspongeUI.controller.options[e]},mixin:function(e,t){e=e||{},t=t||{};for(var o=Object.keys(t),n=0,s=o.length;n<s;n++)e[o[n]]=t[o[n]];return e},mixinOptions:function(e){cloudspongeUI.controller.init(e)},triggerCallback:function(e){var t;if("function"==typeof cloudspongeUI.controller.options[e])try{t=cloudspongeUI.controller.options[e].apply(null,[].slice.call(arguments,1))}catch(e){console.error(e)}return t},trackPage:function(e,t){cloudspongeUI.controller.trackPage(e,t)},trackEvent:function(e,t){if(cloudspongeUI.controller.options.gaTrackEvents&&"function"==typeof ga)try{ga("send",csUtils.mixin({hitType:"event",eventCategory:"CloudSponge Widget",eventAction:e},t))}catch(e){console.error(e)}cloudspongeUI.controller.trackEvent(e,t)},truncate:function(e,t){return e.length>t?e.slice(0,t)+"...":e},fillStr:function(e,t){for(var o,n="",s=0,a=0;(o=e.indexOf("${",++o))>-1;)if(n+=e.slice(s,o),s=e.indexOf("}",o)+1){var c=e.slice(o+2,s-1);"undefined"!=typeof t[c]?n+=t[c]:"undefined"!=typeof t[a]?n+=t[a]:n+="${"+c+"}",a++}else s=o;return n+=e.slice(s)},setHTML:function(e,t){var o;if(e.length)for(var o in e)e[o].innerHTML=t;else e.innerHTML=t},getById:function(e){return document.getElementById(e)},getByClassName:function(e){var t=e,o=1,n=[];"string"==typeof t&&(o=0,t=document);for(var s=arguments.length;o<s;o++)n.push.apply(n,t.getElementsByClassName(arguments[o]));return n},getBySel:function(e,t){return"string"==typeof e?document.querySelectorAll(e):e.querySelectorAll(t)},getByTag:function(e,t){return"string"==typeof e?document.getElementsByTagName(e):e.getElementsByTagName(t)},getText:function(e){return e.textContent||e.innerText},showElement:function(e){"string"==typeof e&&(e=csUtils.getById(e)),e.style.display=""},hideElement:function(e){"string"==typeof e&&(e=csUtils.getById(e)),e.style.display="none"},isHidden:function(e){return"none"==e.style.display},scrollElementY:function(e,t,o){var n=e.scrollTop,s=Math.abs(t-n),a=Math.ceil(s/10);t<n?function s(){n-=a,e.scrollTop=n,t<n?setTimeout(s,10):(e.scrollTop=t,o())}():function s(){n+=a,e.scrollTop=n,n<t?setTimeout(s,10):(e.scrollTop=t,o())}()},delegate:function(e,t){return function(o){for(var n=o.target;this!==n&&!e(n);)n=n.parentNode;this!==n&&t.call(n,o)}},trim:function(e){return null!=e?e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):e},filterBlank:function(e){if(e==undefined)return[];"string"==typeof e&&(e=e.split(" "));for(var t=[],o=0;o<e.length;o++)""!=e[o]&&t.push(e[o]);return t},searchInArray:function(e,t){if(e&&e.length&&e.length>0)for(var o=e.length;o--;)if(0==csUtils.removeAccents(e[o]).toLowerCase().lastIndexOf(t,0))return!0},hasClass:function(e,t){domClasses=csUtils.filterBlank(e.className);for(var o=0;o<domClasses.length;o++)if(domClasses[o]==t)return!0;return!1},addClass:function(e,t){if(!csUtils.hasClass(e,t)){var o=csUtils.filterBlank(e.className);o.push(t),e.className=o.join(" ")}},removeClass:function(e,t){if(csUtils.hasClass(e,t)){for(var o=csUtils.filterBlank(e.className),n=[],s=0;s<o.length;s++)o[s]!=t&&n.push(o[s]);e.className=n.join(" ")}},addEvent:function(e,t,o,n){"undefined"!=typeof e.addEventListener?e.addEventListener(t,o,!!n):"undefined"!=typeof e.attachEvent?e.attachEvent("on"+t,o):e["on"+t]=o},removeEvent:function(e,t,o){"undefined"!=typeof e.removeEventListener?e.removeEventListener(t,o,!1):"undefined"!=typeof e.detachEvent?e.detachEvent("on"+t,o):e["on"+t]=null},preventDefault:function(e){null!=e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},fetchJSON:function(e,t){var o=new XMLHttpRequest;o.onload=function(){try{t(JSON.parse(o.responseText))}catch(e){t({}),console.error(e)}},o.open("GET",e,!0),o.send()},createCORSRequest:function(e,t){var o=new XMLHttpRequest;return"withCredentials"in o?o.open(e,t,!0):"undefined"!=typeof XDomainRequest?(o=new XDomainRequest,o.open(e,t)):o=null,o},removeAccents:function(t){if(t)return t.replace(/[^\u0000-\u007E]/g,function(t){return e[t]||t})},escapeHtml:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(e).replace(/[&<>"'`=\/]/g,function(e){return t[e]})},applyContactMethods:function(e){var t,o={selectedEmail:function(){var e;if(null!==this.email&&"undefined"!=typeof this.email)for(e=0;e<this.email.length;e++)if(this.email[e].selected)return this.email[e].address;return this.primaryEmail&&this.primaryEmail()},primaryEmail:function(){return null!==this.email&&"undefined"!=typeof this.email&&null!==this.email[0]&&"undefined"!=typeof this.email[0]?this.email[0].address:""},fullName:function(){return(this.first_name||"")+" "+(this.last_name||"")},hasValidEmail:function(){var e=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return this.email.filter(function(t){if(e.test(t.address))return t}).length>0}};for(t=0;t<e.length;t++)for(var n in o)n&&(e[t][n]=o[n]);return e},filterNullEmailContacts:function(e){return e.map(function(e){return e.email=e.email.filter(function(e){if(e.address)return e}),e})},copyObj:function(e){switch(function(e){return Object.prototype.toString.call(e).slice(8,-1)}(e)){case"Array":var t,o=new Array,n=e.length;for(t=0;t<n;t++)o[t]=csUtils.copyObj(e[t]);return o;case"Object":var s,o=new Object;for(s in e)o[s]=csUtils.copyObj(e[s]);return o;default:return e}}}}();cloudspongeUI.utils=csUtils;var csTemplate=function(){var e=/<TEMPLATE ([^>]+)>((?:(?!<TEMPLATE)[\s\S])+?)<\/TEMPLATE>/g,t={BOOKS_TAB:csWidgetTemplate.getAddressBooksTab,BOOKS_ENTRY:csWidgetTemplate.getBooksEntry,LOADING_TAB:csWidgetTemplate.getLoadingTab,LOGIN_TAB:csWidgetTemplate.getLoginTab,IMPORT_TAB:csWidgetTemplate.getImportTab,CONTACTS_TAB:csWidgetTemplate.getContactsManagerTab,CONTACT_ITEM:csWidgetTemplate.getContact,CONTACT_EMAIL:csWidgetTemplate.getEmail,CONTACT_PHONE:csWidgetTemplate.getPhone,OPTION_EMAIL:csWidgetTemplate.getOptionEmail,OPTION_PHONE:csWidgetTemplate.getOptionPhone,CONTACT_DETAIL:csWidgetTemplate.getContactDetails,LETTER_ITEM:csWidgetTemplate.getLetter,COPYRIGHT:csWidgetTemplate.getCopyright,STORAGE_MESSAGE:csWidgetTemplate.getStorageMessage,MOBILE_MORE_BUTTON:csWidgetTemplate.getMoreButton};return{TEMPLATE:{BOOKS_TAB:"BOOKS_TAB",BOOKS_ENTRY:"BOOKS_ENTRY",LOADING_TAB:"LOADING_TAB",LOGIN_TAB:"LOGIN_TAB",IMPORT_TAB:"IMPORT_TAB",CONTACTS_TAB:"CONTACTS_TAB",CONTACT_ITEM:"CONTACT_ITEM",CONTACT_EMAIL:"CONTACT_EMAIL",CONTACT_PHONE:"CONTACT_PHONE",LETTER_ITEM:"LETTER_ITEM",OPTION_EMAIL:"OPTION_EMAIL",OPTION_PHONE:"OPTION_PHONE",CONTACT_DETAIL:"CONTACT_DETAIL",COPYRIGHT:"COPYRIGHT",STORAGE_MESSAGE:"STORAGE_MESSAGE",MOBILE_MORE_BUTTON:"MOBILE_MORE_BUTTON"},parse:function(){var e=csUtils.getById(cloudspongeUI.controller.options.templateId);return e&&csTemplate.parseTemplates(csUtils.getText(e)),csTemplate.compile()},parseTemplates:function(o){function n(e,o,n){return t[o]=n,"${"+o+"}"}for(var s="";(o=o.replace(e,n))!==s;)s=o},getTemplate:function(e){if(t.hasOwnProperty(e))return"function"==typeof t[e]?t[e]():t[e]},compile:function(){return csUtils.fillStr(csWidgetTemplate.getBase(),[csTemplate.compileBooksTab()+csTemplate.compileLoadingTab()+csTemplate.compileLoginTab()+csTemplate.compileImportTab()+csTemplate.compileContactsTab()])},compileBooksTab:function(){return csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.BOOKS_TAB),{title:CS_LOCALE.ADDRESS_BOOK})},compileLoadingTab:function(){return csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.LOADING_TAB),{title:CS_LOCALE.AUTHORIZATION,oauthFocus:CS_LOCALE.AUTHORIZATION_FOCUS})},compileLoginTab:function(){return csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.LOGIN_TAB),{title:CS_LOCALE.SIGN_IN,signInAccount:CS_LOCALE.SIGN_IN_ACCOUNT,username:CS_LOCALE.USERNAME,password:CS_LOCALE.PASSWORD,signIn:CS_LOCALE.SIGN_IN,privacyNotice:CS_LOCALE.PRIVACY_NOTICE,privacyDisclaimer:CS_LOCALE.PRIVACY_DISCLAIMER,choiceAnother:CS_LOCALE.CHOICE_ANOTHER,clickHere:CS_LOCALE.CLICK_HERE,icloud_two_steps_verif:CS_LOCALE.ICLOUD_TWO_STEPS_VERIF})},compileImportTab:function(){return csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.IMPORT_TAB),{title:CS_LOCALE.IMPORT_CONTACTS,exportCSV:CS_LOCALE.EXPORT_CSV,dragFiles:CS_LOCALE.DRAG_FILES,dropFiles:CS_LOCALE.DROP_FILES,choiceAnother:CS_LOCALE.CHOICE_ANOTHER,goBack:CS_LOCALE.CLICK_HERE})},compileContactsTab:function(){return csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.CONTACTS_TAB),{title:CS_LOCALE.SELECT_CONTACTS,search_contacts:CS_LOCALE.SEARCH_CONTACTS,search_selected:CS_LOCALE.SEARCH_SELECTED,select_all:CS_LOCALE.SELECT_ALL,deselect_all:CS_LOCALE.DESELECT_ALL,select_search:CS_LOCALE.SELECT_SEARCH,deselect_search:CS_LOCALE.DESELECT_SEARCH,review_booked:CS_LOCALE.REVIEW_SELECTED,back_to_list:CS_LOCALE.BACK_TO_LIST,dict_items:csWidgetTemplate.getDictionary(),no_search_results:CS_LOCALE.NO_SEARCH_RESULTS,no_selected_contacts:CS_LOCALE.NO_SELECTED_CONTACTS,get_contacts:CS_LOCALE.GET_CONTACTS,get_contacts_mobile:CS_LOCALE.GET_CONTACTS_MOBILE})},compileStorageMessage:function(e,t){return t=t&&t.toLocaleString()||"never",csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.STORAGE_MESSAGE),{storage_enabled_status:CS_LOCALE.STORAGE_ENABLED_STATUS,storage_disabled_status:CS_LOCALE.STORAGE_DISABLED_STATUS,logged_as:csUtils.fillStr(CS_LOCALE.STORAGE_LOGGED_AS,["<strong>"+e+"</strong>"]),last_update:csUtils.fillStr(CS_LOCALE.STORAGE_LAST_UPDATE,["<strong>"+t+"</strong>"]),update_now:CS_LOCALE.STORAGE_BT_UPDATE_NOW,disable_cache:CS_LOCALE.STORAGE_BT_DISABLE_CACHE,enable_cache:CS_LOCALE.STORAGE_BT_ENABLE_CACHE})}}}();cloudspongeUI.template=csTemplate;var csWebHooks={afterSubmitContacts:function(e,t,o,n){csWebHooks.post(e,{contacts:t,source:o,owner:n})},post:function(e,t){xdg=new XMLHttpRequest,xdg.open("POST",e),xdg.send(JSON.stringify(t))}};cloudspongeUI.webhooks=csWebHooks;var csModel=function(){function e(e){"function"==typeof e&&(e=e.call());var t=Math.floor(e);return t<0||!t?Infinity:t}function t(e){for(var t=0,o=e.length;t<o;t++){var n=e[t].email;if(n&&n.length){if(e[t].__selectedMail__=n[0].address,!h.IGNORE_MULTIPLE_MAILS)for(var s=0,a=n.length;s<a;s++)if(n[s].primary){e[t].__selectedMail__=n[s].address;break}}else e[t].__selectedMail__="";e[t].selectedEmail=function(){return this.__selectedMail__}}}function o(e){for(var t=0,o=e.length;t<o;t++){var n=e[t].phone;n&&n.length?e[t].__selectedPhone__=n[0].number:e[t].__selectedPhone__="",e[t].selectedPhone=function(){return this.__selectedPhone__}}}function n(e){for(var t=0,o=e.length;t<o;t++){var n=e[t],s=n.__selectedMail__,a=n.first_name,c=n.last_name,i=""==(c||a||s)?"u":(c||a||s)[0].toLowerCase();e[t].__letter__=i<"a"?"}":i,e[t].__rank__=Infinity}}function s(e,t){for(var o=e.email||[],n=t.length;n--;){var s=csUtils.removeAccents(t[n]);if(e.first_name&&0==csUtils.removeAccents(e.first_name).toLowerCase().lastIndexOf(s,0))return!0;if(e.last_name&&0==csUtils.removeAccents(e.last_name).toLowerCase().lastIndexOf(s,0))return!0;if(h.IGNORE_MULTIPLE_MAILS){if(o[0]&&(0==o[0].address.lastIndexOf(s,0)||o[0].address.indexOf("@"+s)>-1))return!0}else for(var a=o.length;a--;)if(0==o[a].address.lastIndexOf(s,0)||o[a].address.indexOf("@"+s)>-1)return!0;if(csUtils.searchInArray(e.groups,s))return!0}return!1}function a(e){return e.sourceProperties=E[u],e.sourceProperties.groups&&cloudspongeUI.controller.options.onlyGroupedContacts&&(e=e.filter(function(e){return e.groups.length})),e.filter(h.FILTER)}function c(e){return!!e.email.length}function i(e,t){return e.__rank__!=t.__rank__?e.__rank__-t.__rank__:e.__letter__.charCodeAt()-t.__letter__.charCodeAt()}function r(){csUtils.trackEvent("onSelectionLimitReached"),"function"==typeof cloudspongeUI.controller.options.onSelectionLimitReached?csUtils.triggerCallback("onSelectionLimitReached",d,h.LIMIT_MESSAGE):alert(h.LIMIT_MESSAGE)}var l,d,u,p,g=null,f=null,m=[],h={},C={OAUTH:1,CSV:2,CREDENTIALS:3},E={gmail:{name:"Gmail",auth:C.OAUTH,groups:!0},yahoo:{name:"Yahoo",auth:C.OAUTH,groups:!1},windowslive:{name:"Outlook.com",auth:C.OAUTH,groups:!1},aol:{name:"AOL",auth:C.OAUTH,groups:!1},office365:{name:"Office 365",auth:C.OAUTH,groups:!1},icloud:{name:"iCloud",auth:C.CREDENTIALS,groups:!1},plaxo:{name:"Plaxo",auth:C.CREDENTIALS,groups:!1},uol:{name:"UOL",auth:C.CREDENTIALS,groups:!1},bol:{name:"BOL",auth:C.CREDENTIALS,groups:!1},terra:{name:"Terra",auth:C.CREDENTIALS,groups:!1},rediff:{name:"Rediff",auth:C.CREDENTIALS,groups:!1},mail126:{name:"126.com",auth:C.CREDENTIALS,groups:!1},mail163:{name:"163.com",auth:C.CREDENTIALS,groups:!1},mail_yeah_net:{name:"Yeah.net",auth:C.CREDENTIALS,groups:!1},mail_ru:{name:"Mail.ru",auth:C.CREDENTIALS,groups:!1},gmx:{name:"GMX",auth:C.CREDENTIALS,groups:!1},web_de:{name:"Web.de",auth:C.CREDENTIALS,groups:!1},qip_ru:{name:"QIP.ru",auth:C.CREDENTIALS,groups:!1},sapo:{name:"SAPO",auth:C.CREDENTIALS,groups:!1},mailcom:{name:"Mail.com",auth:C.CREDENTIALS,groups:!1},yandex_ru:{name:"Yandex",auth:C.CREDENTIALS,groups:!1},poczta_o2:{name:"O2.pl",auth:C.CREDENTIALS,groups:!1},naver:{name:"Naver",auth:C.CREDENTIALS,groups:!1},csv:{name:"Generic CSV",auth:C.CSV,groups:!1,url:""},linkedin:{name:"LinkedIn",auth:C.CSV,groups:!1,url:"https://www.cloudsponge.com/developer/linkedin_instructions/"},outlook:{name:"Outlook",auth:C.CSV,groups:!1,url:"http://office.microsoft.com/en-US/outlook-help/export-contacts-HA101870639.aspx"},addressbook:{name:"Mac Contacts",auth:C.CSV,groups:!1,url:"https://support.apple.com/kb/PH22749"},qq_mail:{name:"QQ mail",auth:C.CSV,groups:!1,url:"http://kf.qq.com/faq/120511z22Uzq130902E7ji6v.html"}},T=["gmail","yahoo","windowslive","linkedin","aol","icloud","outlook","plaxo","mail_ru","uol","bol","terra","rediff","mail126","mail163","mail_yeah_net","gmx","web_de","qip_ru","sapo","mailcom","yandex_ru","addressbook","office365","qq_mail","poczta_o2","naver","csv"];return{AUTH_TYPE:C,OPTIONS:h,initOptions:function(){csModel.OPTIONS=h={SELECT_ALL_NONE:null==cloudspongeUI.controller.options.displaySelectAllNone||cloudspongeUI.controller.options.displaySelectAllNone,INITIALLY_SELECTED:cloudspongeUI.controller.options.initiallySelectedContacts,SELECTION_LIMIT:e(cloudspongeUI.controller.options.selectionLimit),LIMIT_MESSAGE:cloudspongeUI.controller.options.selectionLimitMessage||CS_LOCALE.SELECTION_LIMIT,IGNORE_MULTIPLE_MAILS:cloudspongeUI.controller.options.ignoreMultipleEmails,GROUPED_CONTACTS:cloudspongeUI.controller.options.onlyGroupedContacts,INCLUDE:cloudspongeUI.controller.options.include||[],TEXTAREA_ID:cloudspongeUI.controller.options.textarea_id,TEXTAREA_SELECTOR:cloudspongeUI.controller.options.textareaSelector||".cloudsponge-contacts,.cs-contacts",LINKS_SELECTOR:cloudspongeUI.controller.options.linksSelector||".cloudsponge-launch,.cs-launch,.cs_import",REPLACE_CONTENT:cloudspongeUI.controller.options.replaceContent,CONTACTS_TEMPLATE:cloudspongeUI.controller.options.contactsTemplate,CONTACTS_DELIMITER:cloudspongeUI.controller.options.contactsDelimiter,WEBHOOKS:cloudspongeUI.controller.options.webhooks||{},FILTER:cloudspongeUI.controller.options.filter||c,COMPARE:!1!==cloudspongeUI.controller.options.compare&&(cloudspongeUI.controller.options.compare||i)}},setContacts:function(e){l=Object.create(null),d=0,csContactsView.closeContactsSearch(),m=a(e),t(m),o(m),n(m),h.COMPARE&&m.sort(h.COMPARE),h.INITIALLY_SELECTED&&csModel.selectAll("")},getContacts:function(e){for(var t=[],o=e||{},n=o.onlySelected,a=(csUtils.removeAccents(o.searchStr)||"").trim(),c=a&&a.toLowerCase().split(/\W+/),i=0,r=m.length;i<r;i++){var d=m[i],u=csUtils.escapeHtml(d.first_name+" "+d.last_name),p=" "==u,g=(d.groups,h.IGNORE_MULTIPLE_MAILS?[d.email[0]]:d.email),f=d.phone&&d.phone.length>0?d.phone[0].number:"",C=d.phone,E=(g&&g[0]&&g[0].address)!=undefined&&""!=g[0].address.trim();if(p&&E?u=csUtils.escapeHtml(g[0].address):p&&(u="Unknown"),(!n||l[i])&&(!a||s(m[i],c))){var T="";d.first_name&&d.first_name[0]&&(T+=d.first_name[0]),d.last_name&&d.last_name[0]&&(T+=d.last_name[0]),T.length||(T=g&&g[0]&&g[0].address&&g[0].address[0]||"&nbsp;"),t.push({idx:i,name:u,email:g,job:d.job_title,company:d.companies&&d.companies[0],selected:l[i],isUnknown:p,selectedMail:d.__selectedMail__,letter:d.__letter__,suggested:d.__suggested__,phone:f,phones:C,avatar:T})}}return t},getContactsLength:function(){return m.length},getSelectedLength:function(){return d},isSelected:function(e){return l[e]},formatSelected:function(e,t){var o=[];return t&&t.length&&o.push(t),o=csModel.loadContactsTemplate(e),"undefined"==h.CONTACTS_DELIMITER&&(h.CONTACTS_DELIMITER=", "),o.join(h.CONTACTS_DELIMITER)},loadContactsTemplate:function(e){var t,o=[];if("string"==typeof h.CONTACTS_TEMPLATE){var n={name:csContactsTemplate.getName,email:csContactsTemplate.getEmail,"name+email":csContactsTemplate.getNameEmail,"name+phone":csContactsTemplate.getNamePhone,"name+email+phone":csContactsTemplate.getNameEmailPhone,
"name+email+address":csContactsTemplate.getNameEmailAddress};t=n.hasOwnProperty(h.CONTACTS_TEMPLATE)?n[h.CONTACTS_TEMPLATE]():h.CONTACTS_TEMPLATE}else t=h.INCLUDE.indexOf("name")>-1?csContactsTemplate.getNameEmail():csContactsTemplate.getEmail();for(var s=0,a=e.length;s<a;s++)o.push(csUtils.fillStr(t,csModel.formattedContactHash(e[s])));return o},formattedContactHash:function(e){return{name:e.fullName().trim(),email:e.selectedEmail(),primaryEmail:e.primaryEmail(),firstName:e.first_name,lastName:e.last_name,jobTitle:e.job_title,company:e.companies[0]||"",companies:e.companies.join(" "),groups:e.groups.join(" "),dob:e.dob||"",birthday:e.birthday||"",phone:e.selectedPhone(),emailsList:e.email.map(function(e){return e.address}).join(" "),phonesList:e.phone.map(function(e){return e.number}).join(" "),homeAddress:e.address.map(function(e){if("home"==e.type)return[e.street,e.city,e.region,e.postal_code,e.country]}).join(" ").trim(),workAddress:e.address.map(function(e){if("work"==e.type)return[e.street,e.city,e.region,e.postal_code,e.country]}).join(" ").trim(),otherAddress:e.address.map(function(e){if("other"==e.type)return[e.street,e.city,e.region,e.postal_code,e.country]}).join(" ").trim(),address:e.address.map(function(e){if("home"==e.type)return[e.street,e.city,e.region,e.postal_code,e.country]}).join(" ").trim()}},appendToTextArea:function(e){var t=csUtils.getById(h.TEXTAREA_ID);t&&(t.value=csModel.formatSelected(e,t.value));var o=document.querySelectorAll(h.TEXTAREA_SELECTOR);if(o)for(var n=0,s=o.length;n<s;n++)o[n].value=csModel.formatSelected(e,o[n].value)},appendToWebHook:function(e){for(var t in h.WEBHOOKS){var o=h.WEBHOOKS[t];switch(t){case"afterSubmitContacts":csWebHooks.afterSubmitContacts(o,e,u,g)}}},exportSelected:function(){for(var e=[],t=0,o=m.length;t<o;t++)l[t]&&e.push(m[t]);csModel.appendToTextArea(e),csUtils.triggerCallback("afterSubmitContacts",e,u,g),csUtils.trackEvent("afterSubmitContacts"),csUtils.triggerCallback("onContactsSubmitted",e.length),csUtils.trackEvent("onContactsSubmitted",{eventLabel:"Contacts Submitted",eventValue:e.length}),csUtils.trackPage("/submitted","Submitted Contacts"),csModel.appendToWebHook(e),csWidget.closePopup()},hasMultiMais:function(e){return m[e].email.length>1},selectContact:function(t){return!!l[t]||(d<e(cloudspongeUI.controller.options.selectionLimit)?(l[t]=!0,d++,!0):(r(),!1))},selectAll:function(t){var o=csModel.getContacts({searchStr:t});o.length>e(cloudspongeUI.controller.options.selectionLimit)&&alert(h.LIMIT_MESSAGE);for(var n=0,s=o.length;n<s;n++)if(!csModel.selectContact(o[n].idx))return!1;return!0},unselectContact:function(e){l[e]=!1,d--},unselectAll:function(e){if(""!==e)for(var t=csModel.getContacts({onlySelected:!0,searchStr:e}),o=0,n=t.length;o<n;o++)csModel.unselectContact(t[o].idx);else d=0,l={}},updateContact:function(e,t){m[e].__selectedMail__=t},updateContactPhone:function(e,t){m[e].__selectedPhone__=t},updateContactPhone:function(e,t){m[e].__selectedPhone__=t},updateContactPhone:function(e,t){m[e].__selectedPhone__=t},getContact:function(e){return m[e]},setProvider:function(e){p=u,u=e},getProvider:function(){return u},getOwner:function(){return g},getOwnerEmail:function(){if(g)return g.email&&g.email[0]&&g.email[0].address},setOwner:function(e){g=e},getProvider:function(){return u},getOldProvider:function(){return p},setImportId:function(e){f=e},getImportId:function(){return f},hasSource:function(e){return{}.hasOwnProperty.call(E,e)},getSource:function(e){return csModel.hasSource(e)?E[e]:{}},getAllSources:function(){return T.slice()}}}();cloudspongeUI.model=csModel;var csStorage=function(){function e(e){for(var t=0,o=e.length;t<o;t++)s?e[t].__proto__=a:csUtils.mixin(e[t],a)}function t(){if(csStorage.isEnabled())try{window.localStorage.setItem(n,JSON.stringify(o))}catch(e){"QuotaExceededError"==e.name&&csStorage.disable()}}var o={},n="cloudsponge-data-cache-1",s=!("hasOwnProperty"in{__proto__:null}),a={fullName:function(){return(this.first_name||"")+" "+(this.last_name||"")},primaryEmail:function(){return null!==this.email&&"undefined"!=typeof this.email&&null!==this.email[0]&&"undefined"!=typeof this.email[0]?this.email[0].address:""},selectedEmail:function(){if(null!==this.email&&"undefined"!=typeof this.email){for(var e=0;e<this.email.length;e++)if(this.email[e].selected)return this.email[e].address;return this.primaryEmail&&this.primaryEmail()}}};if(window.localStorage.getItem(n)){o=JSON.parse(window.localStorage.getItem(n));for(var c in o)({}).hasOwnProperty.call(o,c)&&e(o[c].contacts)}return{addSource:function(e,n,s){var a=60*cloudspongeUI.controller.options.browserContactCacheMin*1e3,c=Date.now(),i=c+a;o[e]={source:e,owner:n,createdAt:c,expiredAt:i,contacts:s},t()},getSource:function(e){return o[e]&&o[e].expiredAt<=Date.now()&&(csStorage.removeSource(e),t()),o[e]?o[e]:null},removeSource:function(e){delete o[e]},value:function(){return o},destroy:function(){o={},window.localStorage.removeItem(n)},lastUpdate:function(e){return o[e]&&o[e].createdAt&&new Date(o[e].createdAt)},disable:function(){csStorage.destroy(),csPreferences.get().cacheDisabled=!0,csPreferences.save()},enable:function(){delete csPreferences.get().cacheDisabled,csPreferences.save(),t()},isEnabled:function(){return cloudspongeUI.controller.options.browserContactCacheMin>0&&!csPreferences.get("cacheDisabled")},canBeEnabled:function(){return cloudspongeUI.controller.options.browserContactCacheMin>0}}}();cloudspongeUI.storage=csStorage;var csPreferences=function(){var e={},t="cloudsponge-prefs";return window.localStorage.getItem(t)&&(e=JSON.parse(window.localStorage.getItem(t))),{save:function(){try{window.localStorage.setItem(t,JSON.stringify(e))}catch(e){}},get:function(t){return t?e[t]:e}}}();cloudspongeUI.preferences=csPreferences;var csLoadingView=function(){var e={TEXT:"cloudsponge-loader-text",LOADER:"cloudsponge-loading-gif",TRY_AGAIN:"cloudsponge-error-tryagain",OAUTH_FOCUS:"cloudsponge-oauth-focus",OAUTH_SPAN:"cloudsponge-oauth-focus-span"};return{setAuthorization:function(){csUtils.getById(e.TEXT).innerHTML=CS_LOCALE.AUTHORIZATION+"...",csUtils.showElement(e.LOADER)},loadSource:function(t){var o=csModel.getSource(t.toLowerCase());csUtils.getById(e.TEXT).innerHTML=csUtils.fillStr(CS_LOCALE.LOADING_CONTACTS,{provider:t,name:o.name}),csUtils.showElement(e.LOADER),1==csModel.getSource(t).auth?csUtils.addEvent(csUtils.getById(e.OAUTH_FOCUS),"click",function(){var e=cloudspongeUI.controller.getRpc();if(e.popup&&e.popup.focus)try{e.popup.focus()}catch(e){cloudspongeUI.controller.launch(t)}else cloudspongeUI.controller.launch(t);return!1}):csUtils.hideElement(e.OAUTH_SPAN)},failSource:function(t,o){var n=csModel.getSource(t.toLowerCase())||{},s=CS_LOCALE.UNABLE_LOAD_CONTACTS,a=o&&CS_LOCALE["ERROR_"+o];csUtils.getById(e.TEXT).innerHTML=csUtils.fillStr(s,{name:n.name||t,error_message:a||""}),1==csModel.getSource(t).auth?csUtils.addEvent(csUtils.getById(e.TRY_AGAIN),"click",csWidget.showBooksTab):2==csModel.getSource(t).auth?csUtils.addEvent(csUtils.getById(e.TRY_AGAIN),"click",csWidget.showImportTab):csUtils.addEvent(csUtils.getById(e.TRY_AGAIN),"click",function(){cloudspongeUI.controller.removeIframe(),cloudspongeUI.controller.launch(t)}),csUtils.hideElement(e.LOADER),csUtils.hideElement(e.OAUTH_SPAN)}}}(),csBooksView=function(){var e={BOOKS_LIST:"cloudsponge-providers-list"},t={TWO_BOOKS:"cloudsponge-two-books"};return{init:function(t){csBooksView.renderSources(csBooksView.getSources(t)),csUtils.addEvent(csUtils.getById(e.BOOKS_LIST),"click",csBooksView.onBookClick)},getSources:function(e){var t=[];if(e)for(var o=0,n=e.length;o<n;o++)csModel.hasSource(e[o])&&t.push(e[o]);return 0==t.length?csModel.getAllSources():t},renderSources:function(o){for(var n=[],s=2==o.length?t.TWO_BOOKS:"",a=0,c=o.length;a<c;a++){var i=csModel.getSource(o[a]);n.push(csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.BOOKS_ENTRY),{launcher:o[a],className:o[a],addClass:s,name:i.name}))}csUtils.getById(e.BOOKS_LIST).innerHTML=n.join("")},onBookClick:csUtils.delegate(function(e){var t=e.getAttribute("data-launcher");return void 0!==t&&!!t},function(e){cloudspongeUI.controller.launch(this.getAttribute("data-launcher")),csUtils.preventDefault(e)})}}(),csLoginView=function(){var e={ICON:"cloudsponge-source-icon",NAME:"cloudsponge-source-name",LOGIN_FORM:"cloudsponge-login-form",ERROR_MSG:"cloudsponge-login-error",USERNAME:"cloudsponge-login-user",PASSWORD:"cloudsponge-login-password",BACK:"cloudsponge-login-back",ICLOUD_TWO_STEPS_VERIF:"cloudsponge-icloud-two-steps-verification-message"},t={ICON:"cloudsponge-icon",ERROR:"cloudsponge-error"};return{init:function(){csUtils.addEvent(csUtils.getById(e.LOGIN_FORM),"submit",csLoginView.onSubmit),cloudspongeUI.controller.options.skipSourceMenu&&(csUtils.getById(e.BACK).style.display="none")},setOptions:function(o){csUtils.getById(e.USERNAME).value="",csUtils.getById(e.PASSWORD).value="",csUtils.getById(e.ICON).className=t.ICON+" "+csModel.getProvider(),csUtils.getById(e.NAME).innerHTML=o.name,"icloud"==csModel.getProvider()?csUtils.getById(e.ICLOUD_TWO_STEPS_VERIF).style.display="block":csUtils.getById(e.ICLOUD_TWO_STEPS_VERIF).style.display="none"},isValidForm:function(){var o=csUtils.getById(e.USERNAME),n=csUtils.getById(e.PASSWORD),s=csUtils.getById(e.ERROR_MSG);return o.value.trim()?(csUtils.removeClass(o,t.ERROR),n.value.trim()?(csUtils.removeClass(n,t.ERROR),s.style.display="none",!0):(s.innerHTML=CS_LOCALE.ENTER_PASSWORD,s.style.display="block",csUtils.addClass(n,t.ERROR),!1)):(s.innerHTML=CS_LOCALE.ENTER_USERNAME,s.style.display="block",csUtils.addClass(o,t.ERROR),!1)},onSubmit:function(t){csLoginView.isValidForm()&&cloudspongeUI.controller.login({importId:csModel.getImportId(),source:csModel.getProvider(),authorizationType:"credentials",currentEvent:{eventType:"initializing",status:"inprogress"},requiredFields:["username","password"],username:csUtils.getById(e.USERNAME).value,password:csUtils.getById(e.PASSWORD).value}),csUtils.preventDefault(t)}}}(),csImportView=function(){var e={ICON:"cloudsponge-csv-icon",LINK:"cloudsponge-csv-export",BUTTON:"cloudsponge-csv-contacts",NOT_SUPPORTED:"cloudsponge-csv-not-supported",FILE_FIELD:"cloudsponge-file-upload",FILE_INPUT:"cloudsponge-file-upload-input",UPLOAD_FORM:"cloudsponge-import-form",BACK:"cloudsponge-import-back",GENERIC_CSV_UI:"cloudsponge-csv-generic",SPECIFIC_CSV_UI:"cloudsponge-csv-specific"},t={ICON:"cloudsponge-icon"};return{init:function(){csUtils.addEvent(csUtils.getById(e.FILE_FIELD),"click",csImportView.onClick),csUtils.addEvent(csUtils.getById(e.FILE_INPUT),"change",csImportView.onChange),cloudspongeUI.controller.options.skipSourceMenu&&(csUtils.getById(e.BACK).style.display="none")},setOptions:function(o){csUtils.getById(e.ICON).className=t.ICON+" "+csModel.getProvider(),csUtils.getById(e.LINK).href=o.url,csUtils.getById(e.BUTTON).innerHTML=csUtils.fillStr(CS_LOCALE.GET_CSV_CONTACTS,{name:o.name}),csUtils.getById(e.NOT_SUPPORTED).innerHTML=csUtils.fillStr(CS_LOCALE.NOT_SUPPORTED,{name:o.name});var n,s,a=e.GENERIC_CSV_UI,c=e.SPECIFIC_CSV_UI;for("csv"==csModel.getProvider()&&(a=e.SPECIFIC_CSV_UI,c=e.GENERIC_CSV_UI),n=csUtils.getByClassName(c),s=0;s<n.length;s++)csUtils.showElement(n[s]);for(n=csUtils.getByClassName(a),s=0;s<n.length;s++)csUtils.hideElement(n[s])},setFormAction:function(t){csUtils.getById(e.UPLOAD_FORM).action=t},onClick:function(){csUtils.getById(e.FILE_INPUT).click()},onChange:function(){var t,o,n;o=csUtils.getById(e.UPLOAD_FORM),(n=csUtils.createCORSRequest(o.method,o.action))&&(n.onload=function(e){e.currentTarget&&e.currentTarget.response&&e.currentTarget.response[0]&&cloudspongeUI.controller.loadWidgetUrl(JSON.parse(e.currentTarget.response)[0].url)},t=new FormData(o),t.append("csv_file",csUtils.getById(e.FILE_INPUT).files[0]),n.send(t))}}}(),csContactsView=function(){function e(e){i[e]=1}function t(e){return!!i[e]&&(i[e]=0,!0)}function o(e){return!!i[e]}var n=50,s={SEARCH_BAR:"cloudsponge-search-bar",PROVIDER_ICON:"cloudsponge-provider-icon",SEARCH_CONTACTS:"cloudsponge-search-contacts",SEARCH_BOOKED:"cloudsponge-search-booked",CONTACTS_TITLE:"cloudsponge-contacts-title",CONTACTS_SCROLL:"cloudsponge-contacts-scrolling-region",CONTACTS_LIST:"cloudsponge-contacts-list",EXPORT_BUTTON:"cloudsponge-export-button",GET_CONTACTS:"cloudsponge-get-contacts",GET_CONTACTS_MOBILE:"cloudsponge-get-contacts-mobile",SELECT_ALL_BUTTON:"cloudsponge-select-all",DESELECT_ALL_BUTTON:"cloudsponge-deselect-all",CLOSE_CONTACTS_SEARCH:"cloudsponge-contacts-search-close",CLOSE_BOOKED_SEARCH:"cloudsponge-booked-search-close",SELECT_SEARCH_BUTTON:"cloudsponge-select-search",DESELECT_SEARCH_BUTTON:"cloudsponge-deselect-search",BOOKED_SWITCH:"cloudsponge-review-booked",CONTACTS_SWITCH:"cloudsponge-back-to-list",DICTIONARY:"cloudsponge-dictionary",LETTER_PREVIEW:"cloudsponge-letter-preview",DETAILS_TAB:"cloudsponge-details-tab",CONTACTS_TAB:"cloudsponge-contacts-tab"},a={NO_SEARCH_RESULTS:"cloudsponge-no-search-results",NO_SELECTED_CONTACTS:"cloudsponge-no-selected-contacts"},c={DISABLED:"cloudsponge-disabled",SELECTED:"cloudsponge-selected",CHECKED:"cloudsponge-checked",DEFAULT:"cloudsponge-default",HIDDEN:"cloudsponge-hidden",DELETE:"cross",CHECKBOX:"cloudsponge-checkbox",OPENED:"cloudsponge-opened",NO_NAME:"cloudsponge-no-name",DISABLE_LETTERS:"cloudsponge-disable-letter",ALPHABET_VISIBLE:"cloudsponge-alphabet-visible",MULTIPLE_MAILS:"cloudsponge-multiple-mails",MULTIPLE_PHONES:"cloudsponge-multiple-phones",MAIL_LABEL:"cloudsponge-mail-label",MULTIPLE_PHONES:"cloudsponge-multiple-phones",PHONE_LABEL:"cloudsponge-phone-label"},i={HAS_SELECTED:0,ALL_SELECTED:0,SEARCH_CONTACTS:0,HAS_CONTACTS:0,SEARCH_BOOKED:0,HAS_BOOKED:0,CONTACTS_PANEL:0,REVIEW_PANEL:0,GRANT_SCROLL:0};return{init:function(){csContactsView.__dropdown__=null,csContactsView.initEvents()},show:function(){var e=csModel.getProvider(),t=csModel.getOldProvider();csContactsView.setProvider(e,t),csContactsView.setContactsPlaceholders(csModel.getContactsLength(),e),csContactsView.showContacts()},initEvents:function(){csUtils.addEvent(csUtils.getById(s.CONTACTS_SCROLL),"click",csContactsView.onSelectMail),csUtils.addEvent(csUtils.getById(s.CONTACTS_LIST),"click",csContactsView.onSelectPhone),csUtils.addEvent(csUtils.getById(s.CONTACTS_LIST),"click",csContactsView.onClickMore),csUtils.addEvent(csUtils.getById(s.CONTACTS_SCROLL),"click",csContactsView.onDropDownOpen),csUtils.addEvent(csUtils.getById(s.CONTACTS_SCROLL),"click",csContactsView.onDropDownClose),csUtils.addEvent(csUtils.getById(s.CONTACTS_SCROLL),"click",csContactsView.onRowClick),csUtils.addEvent(csUtils.getById(s.CONTACTS_SCROLL),"mousedown",csContactsView.onSelectClick),csUtils.addEvent(csUtils.getById(s.CONTACTS_SCROLL),"click",csContactsView.onSelectClick),csUtils.addEvent(csUtils.getById(s.CONTACTS_SCROLL),"change",csContactsView.onChangeSelect),csUtils.addEvent(csUtils.getById(s.SEARCH_CONTACTS),"input",csContactsView.onSearchContacts),csUtils.addEvent(csUtils.getById(s.SEARCH_CONTACTS),"focus",csContactsView.hideDictionary),csUtils.addEvent(csUtils.getById(s.SEARCH_CONTACTS),"blur",csContactsView.showDictionary),csUtils.addEvent(csUtils.getById(s.CLOSE_CONTACTS_SEARCH),"click",csContactsView.onCloseSearchContacts),csUtils.addEvent(csUtils.getById(s.SEARCH_BOOKED),"input",csContactsView.onSearchBooked),csUtils.addEvent(csUtils.getById(s.CLOSE_BOOKED_SEARCH),"click",csContactsView.onCloseSearchBooked),csUtils.addEvent(csUtils.getById(s.SELECT_ALL_BUTTON),"click",csContactsView.onBookAllContacts),csUtils.addEvent(csUtils.getById(s.SELECT_SEARCH_BUTTON),"click",csContactsView.onBookAllContacts),csUtils.addEvent(csUtils.getById(s.DESELECT_ALL_BUTTON),"click",csContactsView.onUnBookAllContacts),csUtils.addEvent(csUtils.getById(s.DESELECT_SEARCH_BUTTON),"click",csContactsView.onUnBookAllContacts),csUtils.addEvent(csUtils.getById(s.BOOKED_SWITCH),"click",csContactsView.onShowBooked),csUtils.addEvent(csUtils.getById(s.CONTACTS_SWITCH),"click",csContactsView.onShowContacts),csUtils.addEvent(csUtils.getById(s.CONTACTS_SCROLL),"scroll",csContactsView.onContactsScroll()),csUtils.addEvent(csUtils.getById(s.DICTIONARY),"click",csContactsView.onDictClick),csUtils.addEvent(csUtils.getById(s.EXPORT_BUTTON),"click",csContactsView.onExportContacts)},showContacts:function(){csContactsView.hideBooked(),csContactsView.resetSearchBar(),csContactsView.searchContacts(),e("CONTACTS_PANEL"),csContactsView.updateCounters(),csUtils.triggerCallback("onDisplayContacts"),csUtils.trackEvent("onDisplayContacts")},hideContacts:function(){t("CONTACTS_PANEL")&&(csUtils.triggerCallback("onCloseContacts"),csUtils.trackEvent("onCloseContacts"))},showBooked:function(){csContactsView.hideContacts(),csContactsView.resetSearchBar(),csContactsView.searchBooked(),e("REVIEW_PANEL"),csContactsView.updateCounters(),csUtils.triggerCallback("onDisplaySelectedContacts"),csUtils.trackEvent("onDisplaySelectedContacts")},hideBooked:function(){t("REVIEW_PANEL")&&(csUtils.triggerCallback("onCloseSelectedContacts"),csUtils.trackEvent("onCloseSelectedContacts"))},searchContacts:function(){var o=csUtils.getById(s.SEARCH_CONTACTS),n=csModel.getContacts({searchStr:o.value});csUtils.hideElement(a.NO_SEARCH_RESULTS),csUtils.hideElement(a.NO_SELECTED_CONTACTS),0==n.length?(t("HAS_CONTACTS"),csUtils.hideElement(s.CONTACTS_LIST),csUtils.showElement(a.NO_SEARCH_RESULTS)):(e("HAS_CONTACTS"),csUtils.showElement(s.CONTACTS_LIST),csContactsView.renderContacts(n)),csContactsView.updateSearchCounters(n.length)},searchBooked:function(){var o=csUtils.getById(s.SEARCH_BOOKED),n=(csUtils.getById(s.DESELECT_ALL_BUTTON),o.value.trim()),c=csModel.getContacts({onlySelected:!0,searchStr:n});csUtils.hideElement(a.NO_SEARCH_RESULTS),csUtils.hideElement(a.NO_SELECTED_CONTACTS),0==c.length?(t("HAS_BOOKED"),n?csUtils.showElement(a.NO_SEARCH_RESULTS):csUtils.showElement(a.NO_SELECTED_CONTACTS),csUtils.hideElement(s.CONTACTS_LIST)):(e("HAS_BOOKED"),csUtils.showElement(s.CONTACTS_LIST),csContactsView.renderContacts(csModel.getContacts({onlySelected:!0,searchStr:o.value}))),csContactsView.updateSearchCounters(c.length)},initDictionary:function(){for(var e=csUtils.getById(s.DICTIONARY),t=e.getElementsByTagName("a"),o=t.length;o--;){csUtils.getById(t[o].getAttribute("data-for"))?csUtils.removeClass(t[o],c.DISABLED):csUtils.addClass(t[o],c.DISABLED)}},updateSearchCounters:function(e){var t=csUtils.getById(s.SELECT_SEARCH_BUTTON),o=csUtils.getById(s.DESELECT_SEARCH_BUTTON);t.innerHTML=csUtils.fillStr(CS_LOCALE.SELECT_SEARCH,[e]),o.innerHTML=csUtils.fillStr(CS_LOCALE.DESELECT_SEARCH,[e]),csContactsView.updateUI()},updateCounters:function(){var o=csModel.getSelectedLength(),n=csModel.getContactsLength();csContactsView.setBookedPlaceholders(o),o>0?e("HAS_SELECTED"):t("HAS_SELECTED"),o==n?e("ALL_SELECTED"):t("ALL_SELECTED"),csContactsView.updateUI()},showDictionary:function(){csUtils.showElement(s.DICTIONARY)},hideDictionary:function(){csUtils.hideElement(s.DICTIONARY)},updateUI:function(){csUtils.hideElement(s.BOOKED_SWITCH),csUtils.hideElement(s.SELECT_ALL_BUTTON),csUtils.hideElement(s.DESELECT_ALL_BUTTON),csUtils.hideElement(s.SELECT_SEARCH_BUTTON),csUtils.hideElement(s.DESELECT_SEARCH_BUTTON),csUtils.hideElement(s.DICTIONARY),csUtils.hideElement(s.LETTER_PREVIEW),csContactsView.hideLetters(),csUtils.removeClass(csUtils.getById(s.CONTACTS_LIST),c.ALPHABET_VISIBLE),o("CONTACTS_PANEL")?(csUtils.showElement(s.SEARCH_CONTACTS),o("SEARCH_CONTACTS")||(csContactsView.initDictionary(),csContactsView.showLetters(),"SELECT"!==document.activeElement.tagName&&"cloudsponge-search-contacts"!==document.activeElement.id?csUtils.showElement(s.DICTIONARY):csUtils.addEvent(document.activeElement,"blur",csContactsView.showDictionary),csUtils.addClass(csUtils.getById(s.CONTACTS_LIST),c.ALPHABET_VISIBLE)),o("ALL_SELECTED")&&csModel.OPTIONS.SELECT_ALL_NONE?csUtils.showElement(s.DESELECT_ALL_BUTTON):csModel.OPTIONS.SELECT_ALL_NONE&&csUtils.showElement(s.SELECT_ALL_BUTTON)):csUtils.hideElement(s.SEARCH_CONTACTS),o("REVIEW_PANEL")?(csUtils.showElement(s.SEARCH_BOOKED),csUtils.showElement(s.CONTACTS_SWITCH),o("HAS_SELECTED")&&csModel.OPTIONS.SELECT_ALL_NONE?csUtils.showElement(s.DESELECT_ALL_BUTTON):csUtils.hideElement(s.DESELECT_ALL_BUTTON)):(csUtils.hideElement(s.SEARCH_BOOKED),csUtils.hideElement(s.CONTACTS_SWITCH)),o("SEARCH_CONTACTS")&&o("CONTACTS_PANEL")?(csUtils.showElement(s.CLOSE_CONTACTS_SEARCH),csUtils.showElement(s.SELECT_SEARCH_BUTTON),csUtils.hideElement(s.SELECT_ALL_BUTTON),csUtils.hideElement(s.DESELECT_ALL_BUTTON)):csUtils.hideElement(s.CLOSE_CONTACTS_SEARCH),o("SEARCH_BOOKED")&&o("REVIEW_PANEL")?(csUtils.showElement(s.CLOSE_BOOKED_SEARCH),csUtils.showElement(s.DESELECT_SEARCH_BUTTON),csUtils.hideElement(s.DESELECT_ALL_BUTTON)):csUtils.hideElement(s.CLOSE_BOOKED_SEARCH),o("HAS_SELECTED")?(o("CONTACTS_PANEL")&&csUtils.showElement(s.BOOKED_SWITCH),csContactsView.enableExportButton(),cloudspongeUI.controller.options.alwaysShowCTA||csContactsView.showExportButton()):(csContactsView.disableExportButton(),cloudspongeUI.controller.options.alwaysShowCTA||csContactsView.hideExportButton()),csUtils.getById("cloudsponge-storage-logged-user")&&(csUtils.addEvent(csUtils.getById("cloudsponge-storage-update"),"click",csContactsView.updateStorage),csUtils.addEvent(csUtils.getById("cloudsponge-storage-disable"),"click",csContactsView.disableCache),csUtils.addEvent(csUtils.getById("cloudsponge-storage-enable"),"click",csContactsView.enableCache),csUtils.hideElement(csUtils.getById("cloudsponge-storage-status-disabled")),csUtils.hideElement(csUtils.getById("cloudsponge-storage-status-enabled")),csStorage.isEnabled()?csUtils.showElement(csUtils.getById("cloudsponge-storage-status-enabled")):csStorage.canBeEnabled()&&csUtils.showElement(csUtils.getById("cloudsponge-storage-status-disabled")),csModel.getOwnerEmail()||csUtils.hideElement(csUtils.getById("cloudsponge-storage-logged-user")))},enableCache:function(){csStorage.enable(),csContactsView.updateUI()},disableCache:function(){csStorage.disable(),csContactsView.updateUI()},updateStorage:function(){var e=csModel.getProvider();csStorage.removeSource(e),cloudspongeUI.controller.launch(e)},setZIndex:function(e){for(var t=csUtils.getBySel("#cloudsponge-address-book .cloudsponge-topbar"),o=t.length;o--;)t[o].style.zIndex=e;csUtils.getById(s.EXPORT_BUTTON).style.zIndex=e},setProvider:function(e){var t=csUtils.getById(s.PROVIDER_ICON),o=csUtils.getById(s.SEARCH_CONTACTS),n=t.getAttribute("data-base-class")||"";t.className=n+" "+e,o.placeholder=csUtils.fillStr(CS_LOCALE.SEARCH_CONTACTS,[e])},setContactsPlaceholders:function(e){csUtils.getById(s.SELECT_ALL_BUTTON).innerHTML=csUtils.fillStr(CS_LOCALE.SELECT_ALL,[e])},setBookedPlaceholders:function(e){var t=csUtils.getById(s.GET_CONTACTS),o=csUtils.getById(s.DESELECT_ALL_BUTTON),n=csUtils.getById(s.BOOKED_SWITCH);t.innerHTML=csUtils.fillStr(CS_LOCALE.GET_CONTACTS,[e]),o.innerHTML=csUtils.fillStr(CS_LOCALE.DESELECT_ALL,[e]),n.innerHTML=csUtils.fillStr(CS_LOCALE.REVIEW_SELECTED,[e])},showExportButton:function(){csUtils.showElement(s.EXPORT_BUTTON)},hideExportButton:function(){csUtils.hideElement(s.EXPORT_BUTTON)},disableExportButton:function(){csUtils.addClass(csUtils.getById(s.EXPORT_BUTTON),"disabled")},enableExportButton:function(){csUtils.removeClass(csUtils.getById(s.EXPORT_BUTTON),"disabled")},resetSearchBar:function(){var e=csUtils.getById(s.SEARCH_BAR);csUtils.getById(s.CONTACTS_LIST).scrollTop=0,e.style.top=e.style.marginBottom=0},hideSearchBar:function(){var e=csUtils.getById(s.SEARCH_BAR);e.style.top=e.style.marginBottom=-e.offsetHeight+"px"},hideLetters:function(){var e=csUtils.getById(s.CONTACTS_LIST);csUtils.addClass(e,c.DISABLE_LETTERS)},showLetters:function(){var e=csUtils.getById(s.CONTACTS_LIST);csUtils.removeClass(e,c.DISABLE_LETTERS)},hideDropDown:function(){csContactsView.__dropdown__&&(csUtils.removeClass(csContactsView.__dropdown__,c.OPENED),csContactsView.__dropdown__=null)},closeContactsSearch:function(){t("SEARCH_CONTACTS"),csUtils.getById(s.SEARCH_CONTACTS).value="",csUtils.triggerCallback("onSearchCleared"),csUtils.trackEvent("onSearchCleared"),csContactsView.searchContacts()},closeBookedSearch:function(){t("SEARCH_BOOKED"),csUtils.getById(s.SEARCH_BOOKED).value="",csUtils.triggerCallback("onSearchCleared"),csUtils.trackEvent("onSearchCleared"),csContactsView.searchBooked()},bookContact:function(e){var t=e.getAttribute("data-index");csModel.isSelected(t)||csModel.selectContact(t)&&(csUtils.getByTag(e,"input")[0].checked=!0,csUtils.addClass(e,c.SELECTED),csUtils.triggerCallback("onContactSelected",csModel.getContact(t)),csUtils.trackEvent("onContactSelected")),csContactsView.updateCounters()},bookAllContacts:function(){csModel.selectAll(csUtils.getById(s.SEARCH_CONTACTS).value.trim()),csContactsView.searchContacts(),csContactsView.updateCounters(),csUtils.triggerCallback("onSelectAll"),csUtils.trackEvent("onSelectAll")},unbookContact:function(e){var t=o("REVIEW_PANEL"),n=csModel.getSelectedLength()-1,s=e.getAttribute("data-index");csUtils.removeClass(e,c.SELECTED),csUtils.getByTag(e,"input")[0].checked=!1,csModel.unselectContact(s),csContactsView.updateCounters(),csUtils.triggerCallback("onContactDeselected",csModel.getContact(s)),csUtils.trackEvent("onContactDeselected"),t&&(0==n?csContactsView.searchBooked():csUtils.addClass(e,c.HIDDEN))},unbookAllContacts:function(){o("REVIEW_PANEL")?(csModel.unselectAll(csUtils.getById(s.SEARCH_BOOKED).value.trim()),csContactsView.closeBookedSearch()):(csModel.unselectAll(),csContactsView.searchContacts()),csUtils.triggerCallback("onDeselectAll"),csUtils.trackEvent("onDeselectAll"),csContactsView.updateCounters()},renderContacts:function(e){for(var t="",o="",n=!1,a=0,i=e.length;a<i;a++){var r=e[a],l=r.name.trim(),d=r.selected,u=r.email,p="",g="",f=u.length,m=f>1,h="",C="",E="",T=r.phones,_=T.length,v=_>1;if(r.suggested?n||(t+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.LETTER_ITEM),{letter:CS_LOCALE.SUGGESTIONS}),n=!0):r.letter!==o&&(o=r.letter,t+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.LETTER_ITEM),{letter:"}"==o?"#":o})),m)for(var S=0;S<f;S++){r.selectedMail,u[S].address;p+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.CONTACT_EMAIL),{email:u[S].address,type:u[S].type,primary:u[S].primary,index:r.idx}),g+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.OPTION_EMAIL),{email:u[S].address,type:u[S].type,primary:u[S].primary,index:r.idx,selected:r.selectedMail===u[S].address?'selected="selected"':""})}if(v)for(var S=0;S<_;S++){r.selectedPhone,T[S].number;C+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.CONTACT_PHONE),{phone:T[S].number,type:T[S].type,index:r.idx}),E+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.OPTION_PHONE),{phone:T[S].number,type:T[S].type,index:r.idx,selected:r.selectedPhone===T[S].number?'selected="selected"':""})}(m||v)&&(h=csTemplate.getTemplate(csTemplate.TEMPLATE.MOBILE_MORE_BUTTON));var O={index:r.idx,class_name:d?c.SELECTED:"",unknown_class:r.isUnknown?c.NO_NAME:"",checked:d?'checked="checked"':"",name:l,email:r.selectedMail,phone:r.phone,formatted_email:r.selectedMail,disabled:m?"":'style="display:none;"',multiple_class:m?c.MULTIPLE_MAILS:"",plus_contacts:m?csUtils.fillStr(CS_LOCALE.MORE_MAILS,[f-1]):"",phone_disabled:v?"":'style="display:none;"',phone_multiple_class:v?c.MULTIPLE_PHONES:"",plus_phone:v?csUtils.fillStr(CS_LOCALE.MORE_PHONES,[_-1]):"",multiple_phone_class:v?c.MULTIPLE_PHONES:"",more_button:h,CONTACT_PHONE:C,CONTACT_EMAIL:p,OPTION_EMAIL:g,OPTION_PHONE:E,avatar:r.avatar};t+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.CONTACT_ITEM),O)}csUtils.getById(s.CONTACTS_LIST).innerHTML=t,t=csTemplate.compileStorageMessage(csModel.getOwnerEmail(),csStorage.lastUpdate(csModel.getProvider())),csUtils.setHTML(csUtils.getByClassName("cloudsponge-storage-message"),t),t=csTemplate.getTemplate(csTemplate.TEMPLATE.COPYRIGHT),csUtils.setHTML(csUtils.getByClassName("cloudsponge-copyright-item"),t)},onSearchContacts:function(){var n=csUtils.getById(s.SEARCH_CONTACTS),a=n.value;clearTimeout(csContactsView.onSearchContacts.__timer__),n.value.trim()?csContactsView.onSearchContacts.__timer__=setTimeout(function(){e("SEARCH_CONTACTS"),csUtils.triggerCallback("onSearchEntered",a),csUtils.trackEvent("onSearchEntered",{eventValue:a}),csContactsView.searchContacts()},200):o("SEARCH_CONTACTS")&&(t("SEARCH_CONTACTS"),n.value="",csUtils.triggerCallback("onSearchCleared"),csUtils.trackEvent("onSearchCleared"),csContactsView.searchContacts())},onCloseSearchContacts:function(e){csContactsView.closeContactsSearch(),csUtils.preventDefault(e)},onSearchBooked:function(){var n=csUtils.getById(s.SEARCH_BOOKED),a=n.value;n.value.trim()?(e("SEARCH_BOOKED"),csUtils.triggerCallback("onSearchEntered",a),csUtils.trackEvent("onSearchEntered",{eventValue:a}),csContactsView.searchBooked()):o("SEARCH_BOOKED")&&(t("SEARCH_BOOKED"),n.value="",csUtils.triggerCallback("onSearchCleared"),csUtils.trackEvent("onSearchCleared"),csContactsView.searchBooked())},onCloseSearchBooked:function(e){csContactsView.closeBookedSearch(),csUtils.preventDefault(e)},onRowClick:csUtils.delegate(function(e){return"contact"===e.getAttribute("data-type")},function(e){var t=this,o=t.getAttribute("data-mail"),n=t.getAttribute("data-index");csModel.isSelected(n,o)?csContactsView.unbookContact(this):csContactsView.bookContact(this),csUtils.preventDefault(e)}),onBookAllContacts:function(e){csContactsView.bookAllContacts(),csUtils.preventDefault(e)},onUnBookAllContacts:function(e){CS_LOCALE.DESELECT_CONFIRM&&!window.confirm(CS_LOCALE.DESELECT_CONFIRM)||csContactsView.unbookAllContacts(),csUtils.preventDefault(e)},onDropDownOpen:csUtils.delegate(function(e){return csUtils.hasClass(e,c.MULTIPLE_MAILS)||csUtils.hasClass(e,c.MULTIPLE_PHONES)},function(e){var t=csUtils.getByTag(this,"ul")[0],o=(csUtils.getByTag(this,"select")[0],csContactsView.__dropdown__);csContactsView.hideDropDown(),o!==t&&(csUtils.addClass(t,c.OPENED),csContactsView.__dropdown__=t),e.stopImmediatePropagation(),csUtils.preventDefault(e)}),onDropDownClose:function(){csContactsView.hideDropDown()},onChangeSelect:csUtils.delegate(function(e){return"SELECT"==e.tagName},function(){var e=this.parentNode;label=csUtils.getByClassName(e,c.MAIL_LABEL)[0],id=e.getAttribute("data-index"),csModel.updateContact(id,this.value),csUtils.triggerCallback("onContactEmailSelected",csModel.getContact(id),this.value),csUtils.trackEvent("onContactEmailSelected"),label.innerHTML=csUtils.truncate(this.value,n),label.title=this.value,csContactsView.hideDropDown(),csContactsView.bookContact(e)}),onSelectClick:csUtils.delegate(function(e){return"SELECT"==e.tagName},function(e){var t=this.parentNode,o=t.getAttribute("data-index"),n=!1;csModel.isSelected(o)?(csContactsView.unbookContact(t),n=!0):csContactsView.bookContact(t),!n&&csModel.hasMultiMais(o)||csUtils.preventDefault(e)}),onSelectMail:csUtils.delegate(function(e){return"option"==e.getAttribute("data-type")},function(e){var t=this.getAttribute("data-index"),o=this.getAttribute("data-mail"),s=this.parentNode.parentNode.parentNode.parentNode;label=csUtils.getByClassName(s,c.MAIL_LABEL)[0],o&&(csModel.updateContact(t,o),csUtils.triggerCallback("onContactEmailSelected",csModel.getContact(t),o),csUtils.trackEvent("onContactEmailSelected"),label.innerHTML=csUtils.truncate(o,n),label.title=o,csContactsView.hideDropDown(),csContactsView.bookContact(s),e.stopImmediatePropagation()),csUtils.preventDefault(e)}),onSelectPhone:csUtils.delegate(function(e){return"option"==e.getAttribute("data-type")},function(e){var t=this.getAttribute("data-index"),o=this.getAttribute("data-phone"),n=this.parentNode.parentNode.parentNode.parentNode;label=csUtils.getByClassName(n,c.PHONE_LABEL)[0],o&&(csModel.updateContactPhone(t,o),csUtils.triggerCallback("onContactPhoneSelected",csModel.getContact(t),o),csUtils.trackEvent("onContactPhoneSelected"),label.innerHTML=o,label.title=o,csContactsView.hideDropDown(),csContactsView.bookContact(n),e.stopImmediatePropagation()),csUtils.preventDefault(e)}),onClickMore:csUtils.delegate(function(e){return"more"==e.getAttribute("data-type")},function(){for(var e=this.parentElement.getAttribute("data-index"),t=csModel.getContact(e),o=(t.selected,t.email),a=t.phone,i="",r="",l=o.length,d=a.length,u=0;u<l;u++){t.selectedEmail(),o[u].address;i+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.OPTION_EMAIL),{email:o[u].address,type:o[u].type,primary:o[u].primary,index:t.idx,selected:t.selectedEmail()===o[u].address?'selected="selected"':""})}for(var u=0;u<d;u++){t.selectedPhone(),a[u].number;r+=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.OPTION_PHONE),{phone:a[u].number,type:a[u].type,
index:t.idx,selected:t.selectedPhone()===a[u].number?'selected="selected"':""})}var p=csUtils.getById("cloudsponge-address-book");csUtils.hideElement(s.CONTACTS_TAB);var g=document.createElement("div"),f={title:CS_LOCALE.DETAILS_TITLE,email_label:CS_LOCALE.DETAILS_EMAIL,phone_label:CS_LOCALE.DETAILS_PHONE,id:e,name:t.fullName(),OPTION_EMAIL:i,OPTION_PHONE:r};g.innerHTML=csUtils.fillStr(csTemplate.getTemplate(csTemplate.TEMPLATE.CONTACT_DETAIL),f),g=g.firstChild,p.appendChild(g);for(var m=csUtils.getByClassName("cloudsponge-back-button"),h=m.length;h--;)csUtils.addEvent(m[h],"click",csWidget.onBack);var C=csUtils.getByClassName("cloudsponge-email-select")[0];C&&csUtils.addEvent(C,"change",function(){var e=this.getAttribute("data-index"),t=this.value,o=csUtils.getByClassName("cloudsponge-contact-item").filter(function(t){if(t.getAttribute("data-index")===e)return t})[0],s=csUtils.getByClassName(o,c.MAIL_LABEL)[0];csModel.updateContact(e,t),csUtils.triggerCallback("onContactEmailSelected",csModel.getContact(e),t),csUtils.trackEvent("onContactEmailSelected"),s.innerHTML=csUtils.truncate(t,n),s.title=t,csContactsView.bookContact(o)}),(C=csUtils.getByClassName("cloudsponge-phone-select")[0])&&csUtils.addEvent(C,"change",function(){var e=this.getAttribute("data-index"),t=this.value,o=csUtils.getByClassName("cloudsponge-contact-item").filter(function(t){if(t.getAttribute("data-index")===e)return t})[0],n=csUtils.getByClassName(o,c.PHONE_LABEL)[0];csModel.updateContactPhone(e,t),csUtils.triggerCallback("onContactPhoneSelected",csModel.getContact(e),t),csUtils.trackEvent("onContactPhoneSelected"),n.innerHTML=t,n.title=t,csContactsView.bookContact(o)})}),onShowContacts:function(e){csContactsView.showContacts(),csUtils.preventDefault(e)},onShowBooked:function(e){csContactsView.showBooked(),csUtils.preventDefault(e)},onContactsScroll:function(){var e=csUtils.getById(s.SEARCH_BAR),t=0;return function(){var n=e.offsetHeight;if(!o("GRANT_SCROLL")){var s=this.scrollTop,a=parseInt(e.style.top)||0,c=s-t;s<=0?a=0:s+this.clientHeight>=this.scrollHeight?a=-n:(a-=c,a<-n&&(a=-n),a>0&&(a=0)),e.style.marginBottom=a+"px",e.style.top=a+"px"}t=s}},onDictClick:csUtils.delegate(function(e){return void 0!==e.getAttribute("data-for")&&!csUtils.hasClass(e,c.DISABLED)},function(o){var n=this.getAttribute("data-for"),a=csUtils.getById(n),c=csUtils.getById(s.CONTACTS_SCROLL),i=csUtils.getById(s.LETTER_PREVIEW);csContactsView.hideSearchBar(),i.innerHTML=n.slice(-1),csUtils.showElement(i),e("GRANT_SCROLL"),csUtils.scrollElementY(c,a.offsetTop,function(){t("GRANT_SCROLL"),setTimeout(csUtils.hideElement.bind(null,i),100)}),csUtils.preventDefault(o)}),onExportContacts:function(e){csUtils.hasClass(e.currentTarget,"disabled")||csModel.exportSelected(),csUtils.preventDefault(e)}}}(),csWidget=function(){function e(e,t){var o=document.createElement("link");return o.id=e,o.setAttribute("rel","stylesheet"),o.setAttribute("media","screen"),o.setAttribute("type","text/css"),o.href=t,o}function t(t,o){var n=csUtils.getById(t);if(n){if(n.href===o)return;n.disabled=!0,n.parentNode.removeChild(n)}if(o){var s=e(t,o);document.head.appendChild(s)}}var o,n={OVERLAY:"cloudsponge-overlay",ROOT_HOLDER:"cloudsponge-root-holder",WIDGET:"cloudsponge-address-book",LOADING_OVERLAY:"cloudsponge-loading-overlay",CLOSE_BUTTON:"cloudsponge-close-button",BACK_BUTTON:"cloudsponge-back-button",DESKTOP_BACK:"cloudsponge-desktop-back-button",BACK_CLOSE:"cloudsponge-back-close",CONTACTS_TAB:"cloudsponge-contacts-tab",DETAILS_TAB:"cloudsponge-details-tab",LOADING_TAB:"cloudsponge-loading-tab",LOGIN_TAB:"cloudsponge-login-tab",IMPORT_TAB:"cloudsponge-import-tab",BOOKS_TAB:"cloudsponge-books-tab",CSS_BASE_LINK:"cloudsponge-base-css",CSS_LINK:"cloudsponge-css"},s=!1;return{patchCloudspongeLaunch:function(){cloudsponge.realLaunch||(cloudsponge.realLaunch=cloudsponge.launch,cloudsponge.launch=cloudspongeUI.controller.launch)},initCallbacks:function(){csUtils.mixinOptions({__beforeImport:csWidget.onBeforeImport,__afterImport:csWidget.onAfterImport,__beforeDisplayContacts:csWidget.onBeforeDisplayContacts,__onLaunched:csWidget.onLaunch,__afterInit:csWidget.afterInit,__afterClosing:csWidget.onAfterClose,__afterClosingPopup:csWidget.onAfterClosePopup,__setFormAction:csImportView.setFormAction,__hiddenIframe:!0,csvProviders:{addressbook:!0,outlook:!0}}),csUtils.addEvent(document,"focus",csWidget.onMoveFocus,!0)},initComponents:function(){var e=document.createElement("div"),t=cloudspongeUI.controller.options,o=null;csWidget.initCSS(),t.rootNodeSelector&&(o=document.querySelector(t.rootNodeSelector)),o=o||document.body,o.appendChild(e),e.id=n.ROOT_HOLDER,e.innerHTML=csTemplate.parse(),cloudspongeUI.controller.options.displayContactsColumns&&-1!=cloudspongeUI.controller.options.displayContactsColumns.indexOf("phone")?csUtils.addClass(e,"cloudsponge-columns-3"):csUtils.addClass(e,"cloudsponge-columns-2"),csWidget.setZIndex(),csBooksView.init(t.sources),csLoginView.init(),csImportView.init(),csContactsView.init(),csWidget.initEvents(),csUtils.hideElement(n.OVERLAY),csUtils.hideElement(n.WIDGET)},removeComponents:function(){var e=csUtils.getById(n.ROOT_HOLDER);e&&e.parentNode.removeChild(e),csWidget.setActiveTab(null)},initEvents:function(){var e=csUtils.getOption("linksSelector")||csModel.OPTIONS.LINKS_SELECTOR;if(e)for(var t=document.querySelectorAll(e),o=t.length;o--;)csUtils.addEvent(t[o],"click",csWidget.onShow);for(var s=csUtils.getByClassName(n.CLOSE_BUTTON),o=s.length;o--;)csUtils.addEvent(s[o],"click",csWidget.onClose);for(var a=csUtils.getByClassName(n.BACK_BUTTON,n.DESKTOP_BACK),o=a.length;o--;)csUtils.addEvent(a[o],"click",csWidget.onBack)},initCSS:function(){var e=cloudspongeUI.controller.constants.themePaths[cloudspongeUI.controller.options.theme],o=cloudspongeUI.controller.scriptLocation.origin+(e||cloudspongeUI.controller.constants.defaultCSS);t(n.CSS_BASE_LINK,o),t(n.CSS_LINK,cloudspongeUI.controller.options.css)},initLocale:function(e){var t=null,o=cloudspongeUI.controller.constants.localePaths[cloudspongeUI.controller.options.locale];if(o?t=cloudspongeUI.controller.scriptLocation.origin+o:cloudspongeUI.controller.options.localeData&&(t=cloudspongeUI.controller.options.localeData),null!==t&&"object"==typeof t)csUtils.mixin(CS_LOCALE,t),e();else if("string"==typeof t)try{csUtils.fetchJSON(t,function(t){csUtils.mixin(CS_LOCALE,t),e()})}catch(t){console.error(t),e()}else e()},showPopup:function(){csUtils.showElement(n.OVERLAY),csUtils.showElement(n.WIDGET),s||(s=!0,csUtils.triggerCallback("afterLaunch"),csUtils.trackEvent("afterLaunch"))},closePopup:function(){csUtils.hideElement(n.OVERLAY),csUtils.hideElement(n.WIDGET),csWidget.dispatchTabClose(),csUtils.triggerCallback("onWidgetClosed"),csUtils.trackEvent("onWidgetClosed"),s=!1,csWidget.setActiveTab(null),cloudspongeUI.controller.end(!0)},dispatchTabClose:function(){var e;switch(o){case n.CONTACTS_TAB:e="onCloseContacts";break;case n.LOGIN_TAB:e="onCloseLogin";break;case n.IMPORT_TAB:e="onCloseCSVImport";break;case n.BOOKS_TAB:e="onCloseSources"}e&&(csUtils.triggerCallback(e),csUtils.trackEvent(e))},hideTabs:function(){cloudspongeUI.controller.launching||csUtils.hideElement(n.LOADING_TAB),csUtils.hideElement(n.CONTACTS_TAB),csUtils.hideElement(n.LOGIN_TAB),csUtils.hideElement(n.IMPORT_TAB),csUtils.hideElement(n.BOOKS_TAB),csWidget.dispatchTabClose()},setActiveTab:function(e,t){for(var n=["active-tab-books","active-tab-login","active-tab-loading","active-tab-import","active-tab-contacts","active-tab-error"],s=0;s<n.length;s++){elms=csUtils.getByClassName(n[s]);for(var a=0;a<elms.length;a++)csUtils.removeClass(elms[a],n[s])}o=e,t&&csUtils.addClass(csUtils.getById("cloudsponge-root-holder"),"active-tab-"+t)},showBooksTab:function(){o!==n.BOOKS_TAB&&(csWidget.hideTabs(),csWidget.setActiveTab(n.BOOKS_TAB,"books"),csUtils.showElement(n.BOOKS_TAB),csUtils.trackPage("/choose","Choose"),csUtils.triggerCallback("onDisplaySources"),csUtils.trackEvent("onDisplaySources"))},showContactsTab:function(){csWidget.hideTabs(),csWidget.setActiveTab(n.CONTACTS_TAB,"contacts"),csUtils.showElement(n.CONTACTS_TAB),csContactsView.show()},showLoadingTab:function(e){csWidget.hideTabs(),csWidget.setActiveTab(n.LOADING_TAB,"loading"),csUtils.showElement(n.LOADING_TAB),csLoadingView.setAuthorization(),csLoadingView.loadSource(e)},showLoginTab:function(){csWidget.hideTabs(),csWidget.setActiveTab(n.LOGIN_TAB,"login"),csUtils.showElement(n.LOGIN_TAB),csUtils.triggerCallback("onDisplayLogin"),csUtils.trackEvent("onDisplayLogin")},showImportTab:function(){csWidget.hideTabs(),csWidget.setActiveTab(n.IMPORT_TAB,"import"),csUtils.showElement(n.IMPORT_TAB),csUtils.triggerCallback("onDisplayCSVImport"),csUtils.trackEvent("onDisplayCSVImport")},setZIndex:function(){var e,t=cloudspongeUI.controller.options;"undefined"!=typeof t.zIndex?e=t.zIndex:t.floatbox&&"undefined"!=typeof t.floatbox.zIndex&&(e=t.floatbox.zIndex),void 0!==e&&(csUtils.getById(n.OVERLAY).style.zIndex=e,csUtils.getById(n.WIDGET).style.zIndex=e,csContactsView.setZIndex(e))},onShow:function(e){var t=this.getAttribute("data-cs-source")||this.getAttribute("data-cloudsponge-source");t?cloudspongeUI.controller.launch(t):(csWidget.showPopup(),csWidget.showBooksTab(),csUtils.preventDefault(e))},onAfterClose:function(){s&&csWidget.closePopup()},onAfterClosePopup:function(e){s&&(cloudspongeUI.controller.end(),csWidget.launch(),csUtils.preventDefault(e))},onClose:function(e){cloudspongeUI.controller.end(),csUtils.preventDefault(e)},onBack:function(e){cloudspongeUI.controller.options.skipSourceMenu||csUtils.hasClass(this,n.BACK_CLOSE)?csWidget.closePopup():csUtils.getById(n.DETAILS_TAB)?(csUtils.showElement(n.CONTACTS_TAB),csUtils.getById(n.DETAILS_TAB).remove()):(cloudspongeUI.controller.end(!0),csWidget.showBooksTab()),csUtils.preventDefault(e)},onLaunch:function(e,t){var o=csModel.getSource(e)||{};if(csWidget.showPopup(),e)switch(csUtils.triggerCallback("onSourceSelected",e),csModel.setProvider(e),csModel.setImportId(t),o.auth){case csModel.AUTH_TYPE.CREDENTIALS:csWidget.showLoginTab(),csLoginView.setOptions(o);break;case csModel.AUTH_TYPE.CSV:csWidget.showImportTab(),csImportView.setOptions(o);break;default:csWidget.showLoadingTab(e)}else csWidget.showBooksTab()},afterInit:function(){csWidget.patchCloudspongeLaunch(),csModel.initOptions(),csWidget.removeComponents(),csWidget.initLocale(csWidget.initComponents)},onBeforeImport:function(e){csWidget.showPopup(),csWidget.showLoadingTab(e)},onAfterImport:function(e,t,o){t?(csUtils.triggerCallback("onImportCompleted"),csUtils.trackEvent("onImportCompleted")):(csLoadingView.failSource(e,o),csWidget.setActiveTab(n.LOADING_OVERLAY,"error"),csUtils.triggerCallback("onImportError"),csUtils.trackEvent("onImportError"),csUtils.trackPage("/error/"+e.toLowerCase()+"/"+o,"Error"))},onBeforeDisplayContacts:function(e,t,o,n){csModel.setProvider(t),csModel.setOwner(o),csModel.setContacts(e),csStorage.addSource(t,o,e),n||csWidget.onSkipContactsDisplay(e)},onSkipContactsDisplay:function(e){cloudspongeUI.controller.options.skipContactsDisplay?(csModel.appendToTextArea(e),csWidget.closePopup()):csWidget.showContactsTab()},launch:function(e,t,o){var n=null;return e?(n=csStorage.getSource(e))?(csUtils.triggerCallback("onSourceSelected",e),csUtils.trackEvent("onBeforeDisplayContacts"),!1===csUtils.triggerCallback("beforeDisplayContacts",csUtils.copyObj(n.contacts),e,csUtils.copyObj(n.owner))||cloudspongeUI.controller.options.skipContactsDisplay||(csModel.setProvider(e),csModel.setOwner(n.owner),csModel.setContacts(n.contacts),csWidget.showPopup(),csWidget.showContactsTab(),cloudspongeUI.controller.trackPage("/share","Review and Share")),void 0):cloudspongeUI.controller.realLaunch(e,t,csUtils.mixin(o,{skipSourceMenu:!0})):(csWidget.onLaunch(),!1)},onMoveFocus:function(e){var t=cloudspongeUI.controller.options&&("undefined"==typeof cloudspongeUI.controller.options.modalDialog||cloudspongeUI.controller.options.modalDialog);if(s&&t){for(var o=e.target,a=csUtils.getById(n.ROOT_HOLDER);o;){if(o===a)return void e.stopPropagation();o=o.parentNode}csUtils.preventDefault(e)}}}}();csWidget.initCallbacks(),function(){}.call(this);